<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DamageEx - Live SCF Demo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .scf-container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .section-title {
            font-size: 2rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .live-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #22c55e;
            font-weight: 600;
            font-size: 14px;
        }

        .pulse-dot {
            width: 10px;
            height: 10px;
            background: #22c55e;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(34, 197, 94, 0); }
            100% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0); }
        }

        .demo-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 30px 0;
        }

        .demo-panel {
            background: white;
            border-radius: 15px;
            padding: 25px;
            border: 2px solid #e1e5e9;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .demo-panel.updating {
            border-color: #22c55e;
            box-shadow: 0 0 20px rgba(34, 197, 94, 0.3);
            animation: glow 0.5s ease;
        }

        @keyframes glow {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .panel-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
        }

        .credit-score-display {
            text-align: center;
            margin: 20px 0;
        }

        .score-circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            font-weight: bold;
            color: white;
            position: relative;
            transition: all 0.5s ease;
        }

        .score-excellent { background: linear-gradient(135deg, #22c55e, #16a34a); }
        .score-good { background: linear-gradient(135deg, #3b82f6, #2563eb); }
        .score-fair { background: linear-gradient(135deg, #f59e0b, #d97706); }
        .score-poor { background: linear-gradient(135deg, #ef4444, #dc2626); }

        .score-ring {
            position: absolute;
            top: -5px;
            left: -5px;
            width: 160px;
            height: 160px;
            border: 3px solid transparent;
            border-radius: 50%;
            animation: rotate 2s linear infinite;
        }

        .score-excellent .score-ring { border-top-color: #22c55e; }
        .score-good .score-ring { border-top-color: #3b82f6; }
        .score-fair .score-ring { border-top-color: #f59e0b; }
        .score-poor .score-ring { border-top-color: #ef4444; }

        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .score-details {
            text-align: center;
            margin-top: 15px;
        }

        .score-tier {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .score-range {
            color: #666;
            font-size: 14px;
        }

        .eligibility-display {
            background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid #0891b2;
            text-align: center;
        }

        .eligibility-percentage {
            font-size: 3rem;
            font-weight: 800;
            color: #0891b2;
            margin-bottom: 10px;
            transition: all 0.5s ease;
        }

        .eligibility-amount {
            font-size: 1.5rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .form-input, .form-select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            transform: translateY(-1px);
        }

        .slider-container {
            margin: 15px 0;
        }

        .slider {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: #e1e5e9;
            outline: none;
            transition: all 0.3s ease;
        }

        .slider::-webkit-slider-thumb {
            appearance: none;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }

        .slider::-webkit-slider-thumb:hover {
            transform: scale(1.2);
        }

        .slider-value {
            text-align: center;
            font-weight: bold;
            color: #667eea;
            margin-top: 8px;
            font-size: 1.2rem;
        }

        .calculation-panel {
            background: linear-gradient(135deg, #fef7cd, #fde68a);
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
            border: 2px solid #f59e0b;
            transition: all 0.3s ease;
        }

        .calculation-panel.updating {
            animation: shimmer 0.5s ease;
        }

        @keyframes shimmer {
            0% { background-position: -200px 0; }
            100% { background-position: 200px 0; }
        }

        .calc-header {
            font-weight: 600;
            color: #92400e;
            margin-bottom: 15px;
            font-size: 1.2rem;
            text-align: center;
        }

        .calc-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding: 8px 0;
            font-size: 14px;
        }

        .calc-row.highlight {
            background: rgba(255, 255, 255, 0.6);
            border-radius: 6px;
            padding: 12px;
            font-weight: 600;
            font-size: 16px;
        }

        .calc-row.total {
            border-top: 2px solid #f59e0b;
            font-weight: bold;
            color: #f59e0b;
            font-size: 1.2rem;
            margin-top: 15px;
            padding-top: 15px;
        }

        .risk-assessment {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid #e1e5e9;
        }

        .risk-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 15px;
        }

        .risk-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background: #f8fafc;
            border-radius: 8px;
            border-left: 4px solid #e1e5e9;
        }

        .risk-low {
            border-left-color: #22c55e;
            background: linear-gradient(135deg, #f0fdf4, #dcfce7);
        }

        .risk-medium {
            border-left-color: #f59e0b;
            background: linear-gradient(135deg, #fffbeb, #fef3c7);
        }

        .risk-high {
            border-left-color: #ef4444;
            background: linear-gradient(135deg, #fef2f2, #fecaca);
        }

        .approval-simulator {
            background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0;
            border: 2px solid #0891b2;
            text-align: center;
        }

        .approval-status {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .status-pending { color: #f59e0b; }
        .status-approved { color: #22c55e; }
        .status-rejected { color: #ef4444; }

        .progress-bar {
            width: 100%;
            height: 12px;
            background: #e1e5e9;
            border-radius: 6px;
            overflow: hidden;
            margin: 15px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 6px;
            transition: width 1s ease;
            animation: shimmer-progress 2s infinite;
        }

        @keyframes shimmer-progress {
            0% { background-position: -200px 0; }
            100% { background-position: 200px 0; }
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            font-size: 16px;
            min-width: 200px;
            justify-content: center;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #22c55e, #16a34a);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .btn:active {
            transform: translateY(-1px);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .action-buttons {
            display: flex;
            gap: 20px;
            margin-top: 30px;
            justify-content: center;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            border-left: 4px solid #22c55e;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            z-index: 1000;
            max-width: 350px;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
            font-size: 16px;
        }

        .notification-text {
            font-size: 14px;
            color: #666;
            line-height: 1.4;
        }

        .market-data {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid #e1e5e9;
        }

        .market-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 15px;
        }

        .market-item {
            text-align: center;
            padding: 15px;
            background: #f8fafc;
            border-radius: 8px;
        }

        .market-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .market-label {
            font-size: 12px;
            color: #666;
            text-transform: uppercase;
        }

        .cargo-selector {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid #e1e5e9;
        }

        .cargo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .cargo-option {
            background: #f8fafc;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .cargo-option:hover {
            border-color: #667eea;
            transform: translateY(-2px);
        }

        .cargo-option.selected {
            border-color: #22c55e;
            background: linear-gradient(135deg, #f0fdf4, #dcfce7);
        }

        .cargo-name {
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }

        .cargo-value {
            font-size: 1.2rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .cargo-damage {
            font-size: 12px;
            color: #666;
        }

        @media (max-width: 768px) {
            .demo-grid {
                grid-template-columns: 1fr;
            }
            
            .risk-grid {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <div class="scf-container">
        <div class="section-title">
            <span>💳</span>
            Live SCF Demo - Smart Credit Assessment
            <div class="live-indicator" style="margin-left: auto;">
                <div class="pulse-dot"></div>
                <span>LIVE SYSTEM</span>
            </div>
        </div>

        <!-- Currency Selector Panel -->
        <div class="demo-panel" style="margin-bottom: 30px;">
            <div class="panel-header">
                <div class="panel-title">🌍 Multi-Currency SCF</div>
                <div class="live-indicator">
                    <div class="pulse-dot"></div>
                    <span>LIVE RATES</span>
                </div>
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; align-items: center;">
                <div>
                    <label class="form-label">Select Currency</label>
                    <select class="form-select" id="currencySelector" onchange="changeCurrency()" style="font-size: 16px; padding: 15px;">
                        <option value="INR">🇮🇳 Indian Rupee (₹)</option>
                        <option value="USD">🇺🇸 US Dollar ($)</option>
                        <option value="EUR">🇪🇺 Euro (€)</option>
                        <option value="GBP">🇬🇧 British Pound (£)</option>
                        <option value="JPY">🇯🇵 Japanese Yen (¥)</option>
                        <option value="CNY">🇨🇳 Chinese Yuan (¥)</option>
                        <option value="AUD">🇦🇺 Australian Dollar (A$)</option>
                        <option value="CAD">🇨🇦 Canadian Dollar (C$)</option>
                        <option value="CHF">🇨🇭 Swiss Franc (Fr)</option>
                        <option value="SGD">🇸🇬 Singapore Dollar (S$)</option>
                        <option value="HKD">🇭🇰 Hong Kong Dollar (HK$)</option>
                        <option value="AED">🇦🇪 UAE Dirham (د.إ)</option>
                        <option value="SAR">🇸🇦 Saudi Riyal (ر.س)</option>
                        <option value="KRW">🇰🇷 Korean Won (₩)</option>
                        <option value="BRL">🇧🇷 Brazilian Real (R$)</option>
                        <option value="MXN">🇲🇽 Mexican Peso (Mex$)</option>
                        <option value="RUB">🇷🇺 Russian Ruble (₽)</option>
                        <option value="ZAR">🇿🇦 South African Rand (R)</option>
                        <option value="THB">🇹🇭 Thai Baht (฿)</option>
                        <option value="MYR">🇲🇾 Malaysian Ringgit (RM)</option>
                    </select>
                </div>
                
                <div class="eligibility-display" style="margin: 0;">
                    <div style="font-size: 1.2rem; font-weight: 600; color: #0891b2; margin-bottom: 10px;">
                        Current Exchange Rate
                    </div>
                    <div style="font-size: 1.5rem; font-weight: bold; color: #333;" id="exchangeRateDisplay">
                        1 INR = 1.00 INR
                    </div>
                    <div style="font-size: 12px; color: #666; margin-top: 5px;" id="lastUpdated">
                        Last updated: Just now
                    </div>
                </div>
            </div>
            
            <!-- Quick Currency Converter -->
            <div style="background: #f8fafc; border-radius: 10px; padding: 15px; margin-top: 20px; border: 2px solid #e1e5e9;">
                <h4 style="margin-bottom: 15px; color: #333; text-align: center;">💱 Quick Currency Converter</h4>
                <div style="display: grid; grid-template-columns: 1fr auto 1fr; gap: 15px; align-items: center;">
                    <div>
                        <input type="number" class="form-input" id="convertFrom" value="100000" placeholder="Amount" oninput="convertCurrency()">
                        <div style="text-align: center; margin-top: 5px; font-weight: 600; color: #667eea;">INR</div>
                    </div>
                    <div style="text-align: center; font-size: 1.5rem; color: #667eea;">⇄</div>
                    <div>
                        <input type="text" class="form-input" id="convertTo" readonly style="background: #f0f9ff; font-weight: bold;">
                        <div style="text-align: center; margin-top: 5px; font-weight: 600; color: #667eea;" id="convertToCurrency">INR</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Cargo Selection with Multi-Currency -->
        <div class="cargo-selector">
            <div class="panel-header">
                <div class="panel-title">📦 Select Your Damaged Cargo</div>
            </div>
            <div class="cargo-grid">
                <div class="cargo-option selected" onclick="selectCargo(this)" data-value-inr="293000" data-damage="35" data-type="electronics">
                    <div class="cargo-name">📱 Electronics Container</div>
                    <div class="cargo-value" id="cargo1Value">₹2,93,000</div>
                    <div class="cargo-damage">Water Damage - 35%</div>
                    <div style="font-size: 11px; color: #0891b2; margin-top: 5px;" id="cargo1Converted">$3,516 USD</div>
                </div>
                <div class="cargo-option" onclick="selectCargo(this)" data-value-inr="150000" data-damage="20" data-type="textiles">
                    <div class="cargo-name">👕 Textiles Shipment</div>
                    <div class="cargo-value" id="cargo2Value">₹1,50,000</div>
                    <div class="cargo-damage">Minor Damage - 20%</div>
                    <div style="font-size: 11px; color: #0891b2; margin-top: 5px;" id="cargo2Converted">$1,800 USD</div>
                </div>
                <div class="cargo-option" onclick="selectCargo(this)" data-value-inr="480000" data-damage="60" data-type="machinery">
                    <div class="cargo-name">⚙️ Machinery Parts</div>
                    <div class="cargo-value" id="cargo3Value">₹4,80,000</div>
                    <div class="cargo-damage">Physical Damage - 60%</div>
                    <div style="font-size: 11px; color: #0891b2; margin-top: 5px;" id="cargo3Converted">$5,760 USD</div>
                </div>
                <div class="cargo-option" onclick="selectCargo(this)" data-value-inr="220000" data-damage="25" data-type="chemicals">
                    <div class="cargo-name">🧪 Chemical Products</div>
                    <div class="cargo-value" id="cargo4Value">₹2,20,000</div>
                    <div class="cargo-damage">Container Breach - 25%</div>
                    <div style="font-size: 11px; color: #0891b2; margin-top: 5px;" id="cargo4Converted">$2,640 USD</div>
                </div>
            </div>
        </div>

        <div class="demo-grid">
            <!-- Credit Assessment Panel -->
            <div class="demo-panel" id="creditPanel">
                <div class="panel-header">
                    <div class="panel-title">🎯 Live Credit Assessment</div>
                    <div class="live-indicator">
                        <div class="pulse-dot"></div>
                        <span>ANALYZING</span>
                    </div>
                </div>

                <!-- Credit Score Display -->
                <div class="credit-score-display">
                    <div class="score-circle score-excellent" id="scoreCircle">
                        <div class="score-ring"></div>
                        <span id="creditScore">785</span>
                    </div>
                    <div class="score-details">
                        <div class="score-tier" id="scoreTier">EXCELLENT</div>
                        <div class="score-range" id="scoreRange">750 - 850 Range</div>
                    </div>
                </div>

                <!-- SCF Eligibility -->
                <div class="eligibility-display">
                    <div class="eligibility-percentage" id="eligibilityPercent">65%</div>
                    <div class="eligibility-amount" id="eligibilityAmount">₹1,90,450</div>
                    <div style="font-size: 14px; color: #666;">Maximum SCF Eligible</div>
                </div>

                <!-- Credit Factors Simulator -->
                <div style="margin-top: 25px;">
                    <h4 style="margin-bottom: 15px; color: #333;">🔧 Adjust Credit Factors</h4>
                    
                    <div class="form-group">
                        <label class="form-label">Payment History Score</label>
                        <div class="slider-container">
                            <input type="range" class="slider" id="paymentHistory" min="300" max="850" value="780" oninput="updateCreditScore()">
                            <div class="slider-value" id="paymentValue">780</div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Business Age (Years)</label>
                        <div class="slider-container">
                            <input type="range" class="slider" id="businessAge" min="0" max="25" value="8" oninput="updateCreditScore()">
                            <div class="slider-value" id="ageValue">8 Years</div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Annual Revenue (₹ Crores)</label>
                        <div class="slider-container">
                            <input type="range" class="slider" id="revenue" min="0.5" max="50" value="12" step="0.5" oninput="updateCreditScore()">
                            <div class="slider-value" id="revenueValue">₹12 Cr</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SCF Calculator Panel -->
            <div class="demo-panel" id="calculatorPanel">
                <div class="panel-header">
                    <div class="panel-title">💰 Live SCF Calculator</div>
                    <div class="live-indicator">
                        <div class="pulse-dot"></div>
                        <span>CALCULATING</span>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Expected Auction Value</label>
                    <input type="text" class="form-input" id="auctionValue" value="₹2,93,000" readonly>
                </div>

                <div class="form-group">
                    <label class="form-label">Requested SCF Amount (₹)</label>
                    <div class="slider-container">
                        <input type="range" class="slider" id="scfAmount" min="50000" max="190450" value="150000" step="5000" oninput="calculateSCF()">
                        <div class="slider-value" id="scfValue">₹1,50,000</div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Repayment Period</label>
                    <select class="form-select" id="repaymentPeriod" onchange="calculateSCF()">
                        <option value="30" data-rate="8">30 days (8% APR)</option>
                        <option value="60" data-rate="10">60 days (10% APR)</option>
                        <option value="90" data-rate="12">90 days (12% APR)</option>
                        <option value="120" data-rate="14">120 days (14% APR)</option>
                    </select>
                </div>

                <!-- Live Calculation Display -->
                <div class="calculation-panel" id="calculationPanel">
                    <div class="calc-header">💳 Real-Time SCF Breakdown</div>
                    <div class="calc-row highlight">
                        <span>💰 SCF Amount:</span>
                        <span id="scfAmountDisplay">₹1,50,000</span>
                    </div>
                    <div class="calc-row">
                        <span>📈 Interest Rate:</span>
                        <span id="interestRateDisplay">8% APR</span>
                    </div>
                    <div class="calc-row">
                        <span>💸 Interest Amount:</span>
                        <span id="interestAmount">₹986</span>
                    </div>
                    <div class="calc-row">
                        <span>🏦 Processing Fee (0.5%):</span>
                        <span id="processingFee">₹750</span>
                    </div>
                    <div class="calc-row total">
                        <span>💵 You Receive Today:</span>
                        <span id="netAmount">₹1,49,250</span>
                    </div>
                    <div class="calc-row">
                        <span>🔄 Total Repayment:</span>
                        <span id="repaymentAmount">₹1,50,986</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Risk Assessment -->
        <div class="risk-assessment">
            <div class="panel-header">
                <div class="panel-title">🛡️ Live Risk Assessment</div>
                <div class="live-indicator">
                    <div class="pulse-dot"></div>
                    <span>MONITORING</span>
                </div>
            </div>
            <div class="risk-grid">
                <div class="risk-item risk-low">
                    <span>💳 Credit Risk</span>
                    <span style="color: #22c55e; font-weight: 600;" id="creditRisk">LOW</span>
                </div>
                <div class="risk-item risk-low">
                    <span>🔒 Collateral Security</span>
                    <span style="color: #22c55e; font-weight: 600;">HIGH</span>
                </div>
                <div class="risk-item risk-medium">
                    <span>📊 Market Risk</span>
                    <span style="color: #f59e0b; font-weight: 600;" id="marketRisk">MEDIUM</span>
                </div>
                <div class="risk-item risk-low">
                    <span>💰 Recovery Potential</span>
                    <span style="color: #22c55e; font-weight: 600;" id="recoveryRisk">HIGH</span>
                </div>
            </div>
        </div>

        <!-- Market Data -->
        <div class="market-data">
            <div class="panel-header">
                <div class="panel-title">📈 Live Market Data</div>
                <div class="live-indicator">
                    <div class="pulse-dot"></div>
                    <span>REAL-TIME</span>
                </div>
            </div>
            <div class="market-grid">
                <div class="market-item">
                    <div class="market-value" id="interestRates">8.2%</div>
                    <div class="market-label">Current Interest Rate</div>
                </div>
                <div class="market-item">
                    <div class="market-value" id="approvalRate">94%</div>
                    <div class="market-label">Today's Approval Rate</div>
                </div>
                <div class="market-item">
                    <div class="market-value" id="avgProcessing">2.4h</div>
                    <div class="market-label">Avg Processing Time</div>
                </div>
                <div class="market-item">
                    <div class="market-value" id="totalSCF">₹12.6L</div>
                    <div class="market-label">Today's SCF Volume</div>
                </div>
                <div class="market-item">
                    <div class="market-value" id="recoveryRate">87%</div>
                    <div class="market-label">Recovery Success Rate</div>
                </div>
                <div class="market-item">
                    <div class="market-value" id="activeLoans">156</div>
                    <div class="market-label">Active SCF Loans</div>
                </div>
            </div>
        </div>

        <!-- Approval Simulator -->
        <div class="approval-simulator" id="approvalSimulator">
            <div class="panel-header" style="border: none; padding: 0;">
                <div class="panel-title" style="color: #0891b2;">⚡ Instant Approval Simulator</div>
                <div class="live-indicator">
                    <div class="pulse-dot"></div>
                    <span id="approvalStatus">READY</span>
                </div>
            </div>
            
            <div class="approval-status status-pending" id="statusDisplay">
                🔄 Ready for Application
            </div>
            
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>
            
            <div id="approvalMessage" style="margin: 15px 0; color: #666;">
                Click "Apply for SCF" to start instant processing
            </div>

            <div class="action-buttons">
                <button type="button" class="btn btn-warning" onclick="simulatePreApproval()">
                    ⚡ Quick Pre-Check
                </button>
                <button type="button" class="btn btn-primary" onclick="simulateApplication()" id="applyBtn">
                    🚀 Apply for SCF
                </button>
                <button type="button" class="btn btn-success" onclick="downloadSCFReport()" style="display: none;" id="downloadBtn">
                    📄 Download Agreement
                </button>
            </div>
        </div>
    </div>

    <!-- Notification System -->
    <div class="notification" id="notification">
        <div class="notification-title" id="notificationTitle">System Update</div>
        <div class="notification-text" id="notificationText">Loading...</div>
    </div>

    <script>
        // Global Variables
        let selectedCargo = {
            value: 293000,
            damage: 35,
            type: 'electronics'
        };
        let currentCreditScore = 785;
        let currentTier = 'excellent';
        let currentCurrency = 'INR';
        let exchangeRates = {};
        let marketUpdateInterval;
        let creditUpdateInterval;
        let currencyUpdateInterval;

        // Currency Configuration
        const currencies = {
            'INR': { symbol: '₹', name: 'Indian Rupee', flag: '🇮🇳' },
            'USD': { symbol: '

        // Credit Tiers Configuration
        const creditTiers = {
            excellent: { 
                min: 750, max: 850, percentage: 65, 
                rates: { 30: 8, 60: 10, 90: 12, 120: 14 }, 
                processingFee: 0.5,
                class: 'score-excellent'
            },
            good: { 
                min: 650, max: 749, percentage: 55, 
                rates: { 30: 10, 60: 12, 90: 14, 120: 16 }, 
                processingFee: 0.75,
                class: 'score-good'
            },
            fair: { 
                min: 550, max: 649, percentage: 45, 
                rates: { 30: 12, 60: 14, 90: 16, 120: 18 }, 
                processingFee: 1.0,
                class: 'score-fair'
            },
            poor: { 
                min: 300, max: 549, percentage: 30, 
                rates: { 30: 15, 60: 17, 90: 19, 120: 22 }, 
                processingFee: 1.5,
                class: 'score-poor'
            }
        };

        // Initialize System
        document.addEventListener('DOMContentLoaded', function() {
            initializeExchangeRates();
            updateCreditScore();
            calculateSCF();
            startMarketUpdates();
            startCreditMonitoring();
            startCurrencyUpdates();
            
            // Welcome notification
            setTimeout(() => {
                showNotification('🎉 Multi-Currency SCF Online', 'Live credit assessment with 20+ currencies now active!');
            }, 1000);
        });

        // Currency Functions
        function initializeExchangeRates() {
            // Initialize with base rates and add small random variations
            Object.keys(baseExchangeRates).forEach(currency => {
                const baseRate = baseExchangeRates[currency];
                const variation = (Math.random() - 0.5) * 0.02; // ±1% variation
                exchangeRates[currency] = baseRate * (1 + variation);
            });
            
            updateExchangeRateDisplay();
            convertCurrency();
            updateCargoValueDisplay();
        }

        function startCurrencyUpdates() {
            currencyUpdateInterval = setInterval(() => {
                updateExchangeRates();
            }, 5000); // Update every 5 seconds
        }

        function updateExchangeRates() {
            // Simulate realistic currency fluctuations
            Object.keys(exchangeRates).forEach(currency => {
                if (currency !== 'INR') {
                    const currentRate = exchangeRates[currency];
                    const volatility = getCurrencyVolatility(currency);
                    const change = (Math.random() - 0.5) * volatility;
                    exchangeRates[currency] = Math.max(0.0001, currentRate * (1 + change));
                }
            });
            
            updateExchangeRateDisplay();
            convertCurrency();
            updateCargoValueDisplay();
            updateSCFDisplays();
        }

        function getCurrencyVolatility(currency) {
            // Different currencies have different volatilities
            const volatilities = {
                'USD': 0.002, 'EUR': 0.002, 'GBP': 0.003, 'JPY': 0.003,
                'CNY': 0.001, 'AUD': 0.004, 'CAD': 0.003, 'CHF': 0.002,
                'SGD': 0.002, 'HKD': 0.001, 'AED': 0.001, 'SAR': 0.001,
                'KRW': 0.005, 'BRL': 0.008, 'MXN': 0.006, 'RUB': 0.015,
                'ZAR': 0.010, 'THB': 0.004, 'MYR': 0.003
            };
            return volatilities[currency] || 0.005;
        }

        function changeCurrency() {
            const selector = document.getElementById('currencySelector');
            currentCurrency = selector.value;
            
            updateExchangeRateDisplay();
            convertCurrency();
            updateCargoValueDisplay();
            updateSCFDisplays();
            
            const currencyInfo = currencies[currentCurrency];
            showNotification(`💱 Currency Changed`, `Switched to ${currencyInfo.flag} ${currencyInfo.name}`);
        }

        function updateExchangeRateDisplay() {
            const rateDisplay = document.getElementById('exchangeRateDisplay');
            const lastUpdated = document.getElementById('lastUpdated');
            
            if (currentCurrency === 'INR') {
                rateDisplay.textContent = '1 INR = 1.00 INR';
            } else {
                const rate = exchangeRates[currentCurrency];
                const currencyInfo = currencies[currentCurrency];
                rateDisplay.textContent = `1 INR = ${formatCurrency(rate, currentCurrency)}`;
            }
            
            lastUpdated.textContent = `Last updated: ${new Date().toLocaleTimeString()}`;
        }

        function convertCurrency() {
            const fromAmount = parseFloat(document.getElementById('convertFrom').value) || 0;
            const toInput = document.getElementById('convertTo');
            const toCurrencyLabel = document.getElementById('convertToCurrency');
            
            toCurrencyLabel.textContent = currentCurrency;
            
            if (currentCurrency === 'INR') {
                toInput.value = fromAmount.toLocaleString('en-IN');
            } else {
                const convertedAmount = fromAmount * exchangeRates[currentCurrency];
                toInput.value = formatCurrency(convertedAmount, currentCurrency, false);
            }
        }

        function updateCargoValueDisplay() {
            for (let i = 1; i <= 4; i++) {
                const valueElement = document.getElementById(`cargo${i}Value`);
                const convertedElement = document.getElementById(`cargo${i}Converted`);
                const cargoOption = document.querySelector(`.cargo-option:nth-child(${i})`);
                const valueInr = parseInt(cargoOption.dataset.valueInr);
                
                // Update main value
                if (currentCurrency === 'INR') {
                    valueElement.textContent = `₹${valueInr.toLocaleString('en-IN')}`;
                    convertedElement.textContent = `${Math.round(valueInr * exchangeRates['USD']).toLocaleString()} USD`;
                } else {
                    const convertedValue = valueInr * exchangeRates[currentCurrency];
                    valueElement.textContent = formatCurrency(convertedValue, currentCurrency);
                    convertedElement.textContent = `₹${valueInr.toLocaleString('en-IN')} INR`;
                }
            }
        }

        function updateSCFDisplays() {
            // Update auction value
            const auctionValueEl = document.getElementById('auctionValue');
            if (currentCurrency === 'INR') {
                auctionValueEl.value = `₹${selectedCargo.value.toLocaleString('en-IN')}`;
            } else {
                const convertedValue = selectedCargo.value * exchangeRates[currentCurrency];
                auctionValueEl.value = formatCurrency(convertedValue, currentCurrency);
            }
            
            // Recalculate SCF
            calculateSCF();
        }

        function formatCurrency(amount, currency, includeSymbol = true) {
            const currencyInfo = currencies[currency];
            let formattedAmount;
            
            // Special formatting for different currencies
            switch(currency) {
                case 'JPY':
                case 'KRW':
                    formattedAmount = Math.round(amount).toLocaleString();
                    break;
                case 'BRL':
                case 'MXN':
                    formattedAmount = amount.toFixed(2);
                    break;
                default:
                    if (amount >= 1000) {
                        formattedAmount = Math.round(amount).toLocaleString();
                    } else {
                        formattedAmount = amount.toFixed(2);
                    }
            }
            
            return includeSymbol ? `${currencyInfo.symbol}${formattedAmount}` : formattedAmount;
        }

        function convertToINR(amount, fromCurrency) {
            if (fromCurrency === 'INR') return amount;
            return amount / exchangeRates[fromCurrency];
        }

        function convertFromINR(amount, toCurrency) {
            if (toCurrency === 'INR') return amount;
            return amount * exchangeRates[toCurrency];
        }

        // Cargo Selection
        function selectCargo(element) {
            document.querySelectorAll('.cargo-option').forEach(option => {
                option.classList.remove('selected');
            });
            element.classList.add('selected');
            
            const valueInr = parseInt(element.dataset.valueInr);
            selectedCargo = {
                value: valueInr, // Always store in INR as base
                damage: parseInt(element.dataset.damage),
                type: element.dataset.type
            };
            
            updateSCFDisplays();
            updateCreditScore();
            
            const cargoName = element.querySelector('.cargo-name').textContent;
            const cargoValue = element.querySelector('.cargo-value').textContent;
            showNotification('📦 Cargo Updated', `Selected ${cargoName} worth ${cargoValue}`);
        }

        // Credit Score Calculation
        function updateCreditScore() {
            const paymentHistory = parseInt(document.getElementById('paymentHistory').value);
            const businessAge = parseInt(document.getElementById('businessAge').value);
            const revenue = parseFloat(document.getElementById('revenue').value);
            
            // Update slider displays
            document.getElementById('paymentValue').textContent = paymentHistory;
            document.getElementById('ageValue').textContent = `${businessAge} Years`;
            document.getElementById('revenueValue').textContent = `₹${revenue} Cr`;
            
            // Calculate composite score
            let score = Math.floor(
                paymentHistory * 0.4 +  // 40% weight
                Math.min(businessAge * 25, 200) +  // Business age factor
                Math.min(revenue * 15, 150) +  // Revenue factor
                Math.random() * 20 - 10  // Small random variation
            );
            
            // Adjust for cargo type risk
            const cargoRiskAdjustment = {
                electronics: -10,
                textiles: 0,
                machinery: -15,
                chemicals: -20
            };
            score += cargoRiskAdjustment[selectedCargo.type] || 0;
            
            // Adjust for damage percentage
            score -= selectedCargo.damage * 0.5;
            
            // Ensure score is within bounds
            score = Math.max(300, Math.min(850, score));
            
            currentCreditScore = score;
            
            // Determine tier
            for (const [tier, config] of Object.entries(creditTiers)) {
                if (score >= config.min && score <= config.max) {
                    currentTier = tier;
                    break;
                }
            }
            
            // Update display with animation
            const scoreCircle = document.getElementById('scoreCircle');
            const scoreElement = document.getElementById('creditScore');
            const tierElement = document.getElementById('scoreTier');
            const rangeElement = document.getElementById('scoreRange');
            const eligibilityPercent = document.getElementById('eligibilityPercent');
            const eligibilityAmount = document.getElementById('eligibilityAmount');
            
            // Animate score change
            animateValue(scoreElement, score);
            
            // Update visual styling
            scoreCircle.className = `score-circle ${creditTiers[currentTier].class}`;
            tierElement.textContent = currentTier.toUpperCase();
            rangeElement.textContent = `${creditTiers[currentTier].min} - ${creditTiers[currentTier].max} Range`;
            
            // Update eligibility
            const percentage = creditTiers[currentTier].percentage;
            const maxAmountInr = Math.floor(selectedCargo.value * (percentage / 100));
            const maxAmount = convertFromINR(maxAmountInr, currentCurrency);
            
            animateValue(eligibilityPercent, `${percentage}%`);
            animateValue(eligibilityAmount, formatCurrency(maxAmount, currentCurrency));
            
            // Update SCF slider max
            const scfSlider = document.getElementById('scfAmount');
            scfSlider.max = maxAmountInr; // Keep slider in INR for consistency
            if (parseInt(scfSlider.value) > maxAmountInr) {
                scfSlider.value = maxAmountInr;
            }
            
            // Update risk assessment
            updateRiskAssessment();
            
            // Animate panel
            document.getElementById('creditPanel').classList.add('updating');
            setTimeout(() => {
                document.getElementById('creditPanel').classList.remove('updating');
            }, 500);
            
            // Recalculate SCF
            calculateSCF();
        }

        // SCF Calculation
        function calculateSCF() {
            const scfAmountInr = parseInt(document.getElementById('scfAmount').value);
            const periodSelect = document.getElementById('repaymentPeriod');
            const period = parseInt(periodSelect.value);
            const rate = parseInt(periodSelect.selectedOptions[0].dataset.rate);
            
            // Convert SCF amount to current currency for display
            const scfAmount = convertFromINR(scfAmountInr, currentCurrency);
            
            // Update slider display
            document.getElementById('scfValue').textContent = formatCurrency(scfAmount, currentCurrency);
            
            const tier = creditTiers[currentTier];
            const interestRate = tier.rates[period];
            const processingFeeRate = tier.processingFee;
            
            // Calculate amounts in INR first, then convert
            const interestInr = Math.floor((scfAmountInr * interestRate * period) / (365 * 100));
            const processingFeeInr = Math.floor(scfAmountInr * processingFeeRate / 100);
            const netAmountInr = scfAmountInr - processingFeeInr;
            const repaymentAmountInr = scfAmountInr + interestInr;
            
            // Convert to current currency
            const interest = convertFromINR(interestInr, currentCurrency);
            const processingFee = convertFromINR(processingFeeInr, currentCurrency);
            const netAmount = convertFromINR(netAmountInr, currentCurrency);
            const repaymentAmount = convertFromINR(repaymentAmountInr, currentCurrency);
            
            // Update display with animation
            animateValue(document.getElementById('scfAmountDisplay'), formatCurrency(scfAmount, currentCurrency));
            animateValue(document.getElementById('interestRateDisplay'), `${interestRate}% APR`);
            animateValue(document.getElementById('interestAmount'), formatCurrency(interest, currentCurrency));
            animateValue(document.getElementById('processingFee'), formatCurrency(processingFee, currentCurrency));
            animateValue(document.getElementById('netAmount'), formatCurrency(netAmount, currentCurrency));
            animateValue(document.getElementById('repaymentAmount'), formatCurrency(repaymentAmount, currentCurrency));
            
            // Animate calculation panel
            document.getElementById('calculationPanel').classList.add('updating');
            setTimeout(() => {
                document.getElementById('calculationPanel').classList.remove('updating');
            }, 300);
        }period];
            const processingFeeRate = tier.processingFee;
            
            // Calculate amounts
            const interest = Math.floor((scfAmount * interestRate * period) / (365 * 100));
            const processingFee = Math.floor(scfAmount * processingFeeRate / 100);
            const netAmount = scfAmount - processingFee;
            const repaymentAmount = scfAmount + interest;
            
            // Update display with animation
            animateValue(document.getElementById('scfAmountDisplay'), `₹${scfAmount.toLocaleString()}`);
            animateValue(document.getElementById('interestRateDisplay'), `${interestRate}% APR`);
            animateValue(document.getElementById('interestAmount'), `₹${interest.toLocaleString()}`);
            animateValue(document.getElementById('processingFee'), `₹${processingFee.toLocaleString()}`);
            animateValue(document.getElementById('netAmount'), `₹${netAmount.toLocaleString()}`);
            animateValue(document.getElementById('repaymentAmount'), `₹${repaymentAmount.toLocaleString()}`);
            
            // Animate calculation panel
            document.getElementById('calculationPanel').classList.add('updating');
            setTimeout(() => {
                document.getElementById('calculationPanel').classList.remove('updating');
            }, 300);
        }

        // Risk Assessment Update
        function updateRiskAssessment() {
            const creditRiskEl = document.getElementById('creditRisk');
            const marketRiskEl = document.getElementById('marketRisk');
            const recoveryRiskEl = document.getElementById('recoveryRisk');
            
            // Credit risk based on score
            let creditRisk, marketRisk, recoveryRisk;
            
            if (currentCreditScore >= 750) {
                creditRisk = 'LOW';
                creditRiskEl.style.color = '#22c55e';
            } else if (currentCreditScore >= 650) {
                creditRisk = 'MEDIUM';
                creditRiskEl.style.color = '#f59e0b';
            } else {
                creditRisk = 'HIGH';
                creditRiskEl.style.color = '#ef4444';
            }
            
            // Market risk based on cargo type and damage
            const damageRisk = selectedCargo.damage > 50 ? 'HIGH' : selectedCargo.damage > 30 ? 'MEDIUM' : 'LOW';
            marketRisk = damageRisk;
            
            if (damageRisk === 'LOW') {
                marketRiskEl.style.color = '#22c55e';
            } else if (damageRisk === 'MEDIUM') {
                marketRiskEl.style.color = '#f59e0b';
            } else {
                marketRiskEl.style.color = '#ef4444';
            }
            
            // Recovery risk (inverse of damage)
            recoveryRisk = selectedCargo.damage < 30 ? 'HIGH' : selectedCargo.damage < 60 ? 'MEDIUM' : 'LOW';
            
            creditRiskEl.textContent = creditRisk;
            marketRiskEl.textContent = marketRisk;
            recoveryRiskEl.textContent = recoveryRisk;
        }

        // Market Data Updates with Currency
        function updateMarketData() {
            const data = {
                interestRates: (Math.random() * 0.4 + 8.0).toFixed(1) + '%',
                approvalRate: (Math.random() * 6 + 92).toFixed(0) + '%',
                avgProcessing: (Math.random() * 1.5 + 1.8).toFixed(1) + 'h',
                recoveryRate: (Math.random() * 8 + 84).toFixed(0) + '%',
                activeLoans: Math.floor(Math.random() * 20 + 150)
            };
            
            // Update total SCF volume in current currency
            const totalSCFInr = (Math.random() * 3000000 + 11000000); // 11-14M INR
            const totalSCF = convertFromINR(totalSCFInr, currentCurrency);
            
            if (currentCurrency === 'INR') {
                data.totalSCF = (totalSCFInr / 100000).toFixed(1) + 'L';
            } else {
                const currencyInfo = currencies[currentCurrency];
                if (currentCurrency === 'USD' || currentCurrency === 'EUR' || currentCurrency === 'GBP') {
                    data.totalSCF = currencyInfo.symbol + (totalSCF / 1000).toFixed(0) + 'K';
                } else {
                    data.totalSCF = formatCurrency(totalSCF, currentCurrency);
                }
            }
            
            Object.keys(data).forEach(key => {
                const element = document.getElementById(key);
                if (element && element.textContent !== data[key]) {
                    animateValue(element, data[key]);
                }
            });
        }

        // Enhanced Application Simulation with Currency
        function simulateApplication() {
            const btn = document.getElementById('applyBtn');
            const downloadBtn = document.getElementById('downloadBtn');
            const originalText = btn.textContent;
            
            btn.disabled = true;
            btn.textContent = '⏳ Processing...';
            
            const statusEl = document.getElementById('statusDisplay');
            const progressEl = document.getElementById('progressFill');
            const messageEl = document.getElementById('approvalMessage');
            const approvalStatusEl = document.getElementById('approvalStatus');
            
            // Processing stages
            const stages = [
                { text: '🔍 Verifying Identity...', duration: 1000 },
                { text: '📊 Analyzing Credit Score...', duration: 1500 },
                { text: '📦 Assessing Collateral...', duration: 1200 },
                { text: '💱 Processing Currency Exchange...', duration: 800 },
                { text: '🏦 Checking Bank Details...', duration: 800 },
                { text: '⚡ Final Approval...', duration: 1000 }
            ];
            
            let currentStage = 0;
            let progress = 0;
            
            function processStage() {
                if (currentStage < stages.length) {
                    const stage = stages[currentStage];
                    statusEl.textContent = stage.text;
                    statusEl.className = 'approval-status status-pending';
                    approvalStatusEl.textContent = 'PROCESSING';
                    
                    // Animate progress for this stage
                    const stageProgress = 100 / stages.length;
                    const startProgress = progress;
                    const endProgress = progress + stageProgress;
                    
                    const stageInterval = setInterval(() => {
                        progress += (endProgress - startProgress) / (stage.duration / 50);
                        progressEl.style.width = Math.min(progress, endProgress) + '%';
                        
                        if (progress >= endProgress) {
                            clearInterval(stageInterval);
                            currentStage++;
                            
                            setTimeout(() => {
                                processStage();
                            }, 200);
                        }
                    }, 50);
                } else {
                    // Final result
                    setTimeout(() => {
                        const isApproved = currentCreditScore >= 550;
                        const scfAmount = document.getElementById('scfAmountDisplay').textContent;
                        const netAmount = document.getElementById('netAmount').textContent;
                        const currencyInfo = currencies[currentCurrency];
                        
                        if (isApproved) {
                            statusEl.textContent = '🎉 APPROVED INSTANTLY!';
                            statusEl.className = 'approval-status status-approved';
                            approvalStatusEl.textContent = 'APPROVED';
                            messageEl.innerHTML = `
                                <strong>Congratulations!</strong><br>
                                SCF Amount: ${scfAmount}<br>
                                You Receive: ${netAmount}<br>
                                Currency: ${currencyInfo.flag} ${currencyInfo.name}<br>
                                <small>Funds will be transferred within 2 hours</small>
                            `;
                            
                            btn.style.display = 'none';
                            downloadBtn.style.display = 'inline-flex';
                            
                            showNotification('🎉 SCF APPROVED!', `Instant approval for ${scfAmount} in ${currencyInfo.name}. Funds transferring now!`);
                            
                            // Simulate fund transfer notification
                            setTimeout(() => {
                                showNotification('💰 Funds Transfer', `SCF funds have been credited to your ${currencyInfo.name} account!`);
                            }, 3000);
                            
                        } else {
                            statusEl.textContent = '❌ Application Declined';
                            statusEl.className = 'approval-status status-rejected';
                            approvalStatusEl.textContent = 'DECLINED';
                            messageEl.textContent = 'Application declined due to credit score requirements. You can reapply after improving your credit profile.';
                            
                            showNotification('❌ Application Declined', 'Credit requirements not met. Please improve credit factors and reapply.');
                        }
                        
                        btn.disabled = false;
                        btn.textContent = originalText;
                        
                    }, 500);
                }
            }
            
            processStage();
        }

        // Enhanced Pre-approval with Currency
        function simulatePreApproval() {
            const btn = event.target;
            const originalText = btn.textContent;
            
            btn.disabled = true;
            btn.textContent = '🔍 Checking...';
            
            const statusEl = document.getElementById('statusDisplay');
            const progressEl = document.getElementById('progressFill');
            const messageEl = document.getElementById('approvalMessage');
            
            statusEl.textContent = '🔍 Running Multi-Currency Pre-Check...';
            statusEl.className = 'approval-status status-pending';
            
            // Animate progress
            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += Math.random() * 15 + 5;
                progressEl.style.width = Math.min(progress, 100) + '%';
                
                if (progress >= 100) {
                    clearInterval(progressInterval);
                    
                    // Show result
                    setTimeout(() => {
                        const isApproved = currentCreditScore >= 550;
                        const maxAmountInr = Math.floor(selectedCargo.value * (creditTiers[currentTier].percentage / 100));
                        const maxAmount = convertFromINR(maxAmountInr, currentCurrency);
                        const currencyInfo = currencies[currentCurrency];
                        
                        if (isApproved) {
                            statusEl.textContent = '✅ Pre-Approved!';
                            statusEl.className = 'approval-status status-approved';
                            messageEl.innerHTML = `
                                Great! You're pre-approved for up to <strong>${formatCurrency(maxAmount, currentCurrency)}</strong><br>
                                in ${currencyInfo.flag} ${currencyInfo.name}. Ready to apply?
                            `;
                            
                            showNotification('✅ Pre-Approval Success', `You qualify for instant SCF approval in ${currencyInfo.name}!`);
                        } else {
                            statusEl.textContent = '❌ Pre-Check Failed';
                            statusEl.className = 'approval-status status-rejected';
                            messageEl.textContent = 'Credit score too low for instant approval. Consider improving credit factors.';
                            
                            showNotification('❌ Pre-Approval Declined', 'Credit score needs improvement for SCF eligibility.');
                        }
                        
                        btn.disabled = false;
                        btn.textContent = originalText;
                        
                        // Reset after 5 seconds
                        setTimeout(() => {
                            progressEl.style.width = '0%';
                            statusEl.textContent = '🔄 Ready for Application';
                            statusEl.className = 'approval-status status-pending';
                            messageEl.textContent = 'Click "Apply for SCF" to start instant processing';
                        }, 5000);
                        
                    }, 1000);
                }
            }, 100);
        }

        // Enhanced Download Report with Currency
        function downloadSCFReport() {
            const currencyInfo = currencies[currentCurrency];
            showNotification('📄 Generating Agreement', `SCF loan agreement in ${currencyInfo.name} being prepared...`);
            
            setTimeout(() => {
                showNotification('📄 Download Complete', `Multi-currency SCF agreement (${currencyInfo.flag} ${currencyInfo.name}) downloaded successfully.`);
            }, 2000);
        }

        // Cleanup
        window.addEventListener('beforeunload', function() {
            clearInterval(marketUpdateInterval);
            clearInterval(creditUpdateInterval);
            clearInterval(currencyUpdateInterval);
        });

        // Enhanced Auto-demo with Currency Switching
        function startAutoDemo() {
            const cargos = document.querySelectorAll('.cargo-option');
            const currencyKeys = Object.keys(currencies);
            let cargoIndex = 0;
            let currencyIndex = 0;
            
            setInterval(() => {
                // Switch cargo
                cargos[cargoIndex].click();
                cargoIndex = (cargoIndex + 1) % cargos.length;
                
                // Switch currency every 3 cargo switches
                if (cargoIndex % 3 === 0) {
                    document.getElementById('currencySelector').value = currencyKeys[currencyIndex];
                    changeCurrency();
                    currencyIndex = (currencyIndex + 1) % currencyKeys.length;
                }
                
                // Random credit adjustments
                setTimeout(() => {
                    const sliders = ['paymentHistory', 'businessAge', 'revenue'];
                    const randomSlider = sliders[Math.floor(Math.random() * sliders.length)];
                    const slider = document.getElementById(randomSlider);
                    const range = slider.max - slider.min;
                    slider.value = parseInt(slider.min) + Math.floor(Math.random() * range);
                    updateCreditScore();
                }, 2000);
                
            }, 8000);
        }

        // Uncomment to enable auto-demo with currency switching
        // setTimeout(startAutoDemo, 10000);

        // Credit Monitoring
        function startCreditMonitoring() {
            creditUpdateInterval = setInterval(() => {
                // Small random credit score fluctuations
                if (Math.random() < 0.3) { // 30% chance
                    const currentScore = parseInt(document.getElementById('creditScore').textContent);
                    const variation = Math.floor(Math.random() * 6) - 3; // -3 to +3
                    const newScore = Math.max(300, Math.min(850, currentScore + variation));
                    
                    if (newScore !== currentScore) {
                        currentCreditScore = newScore;
                        animateValue(document.getElementById('creditScore'), newScore);
                        
                        showNotification('📊 Credit Update', `Credit score updated to ${newScore} (${variation > 0 ? '+' : ''}${variation})`);
                    }
                }
            }, 8000);
        }

        // Application Simulation
        function simulatePreApproval() {
            const btn = event.target;
            const originalText = btn.textContent;
            
            btn.disabled = true;
            btn.textContent = '🔍 Checking...';
            
            const statusEl = document.getElementById('statusDisplay');
            const progressEl = document.getElementById('progressFill');
            const messageEl = document.getElementById('approvalMessage');
            
            statusEl.textContent = '🔍 Running Pre-Check...';
            statusEl.className = 'approval-status status-pending';
            
            // Animate progress
            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += Math.random() * 15 + 5;
                progressEl.style.width = Math.min(progress, 100) + '%';
                
                if (progress >= 100) {
                    clearInterval(progressInterval);
                    
                    // Show result
                    setTimeout(() => {
                        const isApproved = currentCreditScore >= 550; // Minimum threshold
                        
                        if (isApproved) {
                            statusEl.textContent = '✅ Pre-Approved!';
                            statusEl.className = 'approval-status status-approved';
                            messageEl.textContent = `Great! You're pre-approved for up to ₹${Math.floor(selectedCargo.value * (creditTiers[currentTier].percentage / 100)).toLocaleString()}. Ready to apply?`;
                            
                            showNotification('✅ Pre-Approval Success', 'You qualify for instant SCF approval!');
                        } else {
                            statusEl.textContent = '❌ Pre-Check Failed';
                            statusEl.className = 'approval-status status-rejected';
                            messageEl.textContent = 'Credit score too low for instant approval. Consider improving credit factors.';
                            
                            showNotification('❌ Pre-Approval Declined', 'Credit score needs improvement for SCF eligibility.');
                        }
                        
                        btn.disabled = false;
                        btn.textContent = originalText;
                        
                        // Reset after 5 seconds
                        setTimeout(() => {
                            progressEl.style.width = '0%';
                            statusEl.textContent = '🔄 Ready for Application';
                            statusEl.className = 'approval-status status-pending';
                            messageEl.textContent = 'Click "Apply for SCF" to start instant processing';
                        }, 5000);
                        
                    }, 1000);
                }
            }, 100);
        }

        function simulateApplication() {
            const btn = document.getElementById('applyBtn');
            const downloadBtn = document.getElementById('downloadBtn');
            const originalText = btn.textContent;
            
            btn.disabled = true;
            btn.textContent = '⏳ Processing...';
            
            const statusEl = document.getElementById('statusDisplay');
            const progressEl = document.getElementById('progressFill');
            const messageEl = document.getElementById('approvalMessage');
            const approvalStatusEl = document.getElementById('approvalStatus');
            
            // Processing stages
            const stages = [
                { text: '🔍 Verifying Identity...', duration: 1000 },
                { text: '📊 Analyzing Credit Score...', duration: 1500 },
                { text: '📦 Assessing Collateral...', duration: 1200 },
                { text: '🏦 Checking Bank Details...', duration: 800 },
                { text: '⚡ Final Approval...', duration: 1000 }
            ];
            
            let currentStage = 0;
            let progress = 0;
            
            function processStage() {
                if (currentStage < stages.length) {
                    const stage = stages[currentStage];
                    statusEl.textContent = stage.text;
                    statusEl.className = 'approval-status status-pending';
                    approvalStatusEl.textContent = 'PROCESSING';
                    
                    // Animate progress for this stage
                    const stageProgress = 100 / stages.length;
                    const startProgress = progress;
                    const endProgress = progress + stageProgress;
                    
                    const stageInterval = setInterval(() => {
                        progress += (endProgress - startProgress) / (stage.duration / 50);
                        progressEl.style.width = Math.min(progress, endProgress) + '%';
                        
                        if (progress >= endProgress) {
                            clearInterval(stageInterval);
                            currentStage++;
                            
                            setTimeout(() => {
                                processStage();
                            }, 200);
                        }
                    }, 50);
                } else {
                    // Final result
                    setTimeout(() => {
                        const isApproved = currentCreditScore >= 550;
                        const scfAmount = document.getElementById('scfAmountDisplay').textContent;
                        const netAmount = document.getElementById('netAmount').textContent;
                        
                        if (isApproved) {
                            statusEl.textContent = '🎉 APPROVED INSTANTLY!';
                            statusEl.className = 'approval-status status-approved';
                            approvalStatusEl.textContent = 'APPROVED';
                            messageEl.innerHTML = `
                                <strong>Congratulations!</strong><br>
                                SCF Amount: ${scfAmount}<br>
                                You Receive: ${netAmount}<br>
                                <small>Funds will be transferred within 2 hours</small>
                            `;
                            
                            btn.style.display = 'none';
                            downloadBtn.style.display = 'inline-flex';
                            
                            showNotification('🎉 SCF APPROVED!', `Instant approval for ${scfAmount}. Funds transferring now!`);
                            
                            // Add to activity (if dashboard is available)
                            setTimeout(() => {
                                showNotification('💰 Funds Transfer', 'SCF funds have been credited to your account!');
                            }, 3000);
                            
                        } else {
                            statusEl.textContent = '❌ Application Declined';
                            statusEl.className = 'approval-status status-rejected';
                            approvalStatusEl.textContent = 'DECLINED';
                            messageEl.textContent = 'Application declined due to credit score requirements. You can reapply after improving your credit profile.';
                            
                            showNotification('❌ Application Declined', 'Credit requirements not met. Please improve credit factors and reapply.');
                        }
                        
                        btn.disabled = false;
                        btn.textContent = originalText;
                        
                    }, 500);
                }
            }
            
            processStage();
        }

        function downloadSCFReport() {
            showNotification('📄 Generating Agreement', 'SCF loan agreement and terms being prepared...');
            
            setTimeout(() => {
                showNotification('📄 Download Complete', 'SCF agreement downloaded successfully. Please review and sign.');
            }, 2000);
        }

        // Utility Functions
        function animateValue(element, newValue) {
            const currentValue = element.textContent;
            if (currentValue !== newValue.toString()) {
                element.style.color = '#22c55e';
                element.style.transform = 'scale(1.05)';
                element.textContent = newValue;
                
                setTimeout(() => {
                    element.style.color = '';
                    element.style.transform = 'scale(1)';
                }, 400);
            }
        }

        function showNotification(title, text) {
            const notification = document.getElementById('notification');
            const titleEl = document.getElementById('notificationTitle');
            const textEl = document.getElementById('notificationText');
            
            titleEl.textContent = title;
            textEl.textContent = text;
            
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 4000);
        }

        // Cleanup
        window.addEventListener('beforeunload', function() {
            clearInterval(marketUpdateInterval);
            clearInterval(creditUpdateInterval);
        });

        // Auto-demo mode (optional)
        function startAutoDemo() {
            const cargos = document.querySelectorAll('.cargo-option');
            let cargoIndex = 0;
            
            setInterval(() => {
                // Switch cargo
                cargos[cargoIndex].click();
                cargoIndex = (cargoIndex + 1) % cargos.length;
                
                // Random credit adjustments
                setTimeout(() => {
                    const sliders = ['paymentHistory', 'businessAge', 'revenue'];
                    const randomSlider = sliders[Math.floor(Math.random() * sliders.length)];
                    const slider = document.getElementById(randomSlider);
                    const range = slider.max - slider.min;
                    slider.value = parseInt(slider.min) + Math.floor(Math.random() * range);
                    updateCreditScore();
                }, 2000);
                
            }, 8000);
        }

        // Uncomment to enable auto-demo
        // setTimeout(startAutoDemo, 10000);
    </script>
</body>
</html>, name: 'US Dollar', flag: '🇺🇸' },
            'EUR': { symbol: '€', name: 'Euro', flag: '🇪🇺' },
            'GBP': { symbol: '£', name: 'British Pound', flag: '🇬🇧' },
            'JPY': { symbol: '¥', name: 'Japanese Yen', flag: '🇯🇵' },
            'CNY': { symbol: '¥', name: 'Chinese Yuan', flag: '🇨🇳' },
            'AUD': { symbol: 'A

        // Credit Tiers Configuration
        const creditTiers = {
            excellent: { 
                min: 750, max: 850, percentage: 65, 
                rates: { 30: 8, 60: 10, 90: 12, 120: 14 }, 
                processingFee: 0.5,
                class: 'score-excellent'
            },
            good: { 
                min: 650, max: 749, percentage: 55, 
                rates: { 30: 10, 60: 12, 90: 14, 120: 16 }, 
                processingFee: 0.75,
                class: 'score-good'
            },
            fair: { 
                min: 550, max: 649, percentage: 45, 
                rates: { 30: 12, 60: 14, 90: 16, 120: 18 }, 
                processingFee: 1.0,
                class: 'score-fair'
            },
            poor: { 
                min: 300, max: 549, percentage: 30, 
                rates: { 30: 15, 60: 17, 90: 19, 120: 22 }, 
                processingFee: 1.5,
                class: 'score-poor'
            }
        };

        // Initialize System
        document.addEventListener('DOMContentLoaded', function() {
            updateCreditScore();
            calculateSCF();
            startMarketUpdates();
            startCreditMonitoring();
            
            // Welcome notification
            setTimeout(() => {
                showNotification('🎉 SCF System Online', 'Live credit assessment and real-time calculations active!');
            }, 1000);
        });

        // Cargo Selection
        function selectCargo(element) {
            document.querySelectorAll('.cargo-option').forEach(option => {
                option.classList.remove('selected');
            });
            element.classList.add('selected');
            
            selectedCargo = {
                value: parseInt(element.dataset.value),
                damage: parseInt(element.dataset.damage),
                type: element.dataset.type
            };
            
            // Update auction value display
            document.getElementById('auctionValue').value = `₹${selectedCargo.value.toLocaleString()}`;
            
            // Update SCF slider max
            const maxSCF = Math.floor(selectedCargo.value * (creditTiers[currentTier].percentage / 100));
            const scfSlider = document.getElementById('scfAmount');
            scfSlider.max = maxSCF;
            
            // Reset to 50% of max eligibility
            const newAmount = Math.floor(maxSCF * 0.75);
            scfSlider.value = newAmount;
            
            updateCreditScore();
            calculateSCF();
            
            showNotification('📦 Cargo Updated', `Selected ${element.querySelector('.cargo-name').textContent} worth ${element.querySelector('.cargo-value').textContent}`);
        }

        // Credit Score Calculation
        function updateCreditScore() {
            const paymentHistory = parseInt(document.getElementById('paymentHistory').value);
            const businessAge = parseInt(document.getElementById('businessAge').value);
            const revenue = parseFloat(document.getElementById('revenue').value);
            
            // Update slider displays
            document.getElementById('paymentValue').textContent = paymentHistory;
            document.getElementById('ageValue').textContent = `${businessAge} Years`;
            document.getElementById('revenueValue').textContent = `₹${revenue} Cr`;
            
            // Calculate composite score
            let score = Math.floor(
                paymentHistory * 0.4 +  // 40% weight
                Math.min(businessAge * 25, 200) +  // Business age factor
                Math.min(revenue * 15, 150) +  // Revenue factor
                Math.random() * 20 - 10  // Small random variation
            );
            
            // Adjust for cargo type risk
            const cargoRiskAdjustment = {
                electronics: -10,
                textiles: 0,
                machinery: -15,
                chemicals: -20
            };
            score += cargoRiskAdjustment[selectedCargo.type] || 0;
            
            // Adjust for damage percentage
            score -= selectedCargo.damage * 0.5;
            
            // Ensure score is within bounds
            score = Math.max(300, Math.min(850, score));
            
            currentCreditScore = score;
            
            // Determine tier
            for (const [tier, config] of Object.entries(creditTiers)) {
                if (score >= config.min && score <= config.max) {
                    currentTier = tier;
                    break;
                }
            }
            
            // Update display with animation
            const scoreCircle = document.getElementById('scoreCircle');
            const scoreElement = document.getElementById('creditScore');
            const tierElement = document.getElementById('scoreTier');
            const rangeElement = document.getElementById('scoreRange');
            const eligibilityPercent = document.getElementById('eligibilityPercent');
            const eligibilityAmount = document.getElementById('eligibilityAmount');
            
            // Animate score change
            animateValue(scoreElement, score);
            
            // Update visual styling
            scoreCircle.className = `score-circle ${creditTiers[currentTier].class}`;
            tierElement.textContent = currentTier.toUpperCase();
            rangeElement.textContent = `${creditTiers[currentTier].min} - ${creditTiers[currentTier].max} Range`;
            
            // Update eligibility
            const percentage = creditTiers[currentTier].percentage;
            const maxAmount = Math.floor(selectedCargo.value * (percentage / 100));
            
            animateValue(eligibilityPercent, `${percentage}%`);
            animateValue(eligibilityAmount, `₹${maxAmount.toLocaleString()}`);
            
            // Update SCF slider max
            const scfSlider = document.getElementById('scfAmount');
            scfSlider.max = maxAmount;
            if (parseInt(scfSlider.value) > maxAmount) {
                scfSlider.value = maxAmount;
            }
            
            // Update risk assessment
            updateRiskAssessment();
            
            // Animate panel
            document.getElementById('creditPanel').classList.add('updating');
            setTimeout(() => {
                document.getElementById('creditPanel').classList.remove('updating');
            }, 500);
            
            // Recalculate SCF
            calculateSCF();
        }

        // SCF Calculation
        function calculateSCF() {
            const scfAmount = parseInt(document.getElementById('scfAmount').value);
            const periodSelect = document.getElementById('repaymentPeriod');
            const period = parseInt(periodSelect.value);
            const rate = parseInt(periodSelect.selectedOptions[0].dataset.rate);
            
            // Update slider display
            document.getElementById('scfValue').textContent = `₹${scfAmount.toLocaleString()}`;
            
            const tier = creditTiers[currentTier];
            const interestRate = tier.rates[period];
            const processingFeeRate = tier.processingFee;
            
            // Calculate amounts
            const interest = Math.floor((scfAmount * interestRate * period) / (365 * 100));
            const processingFee = Math.floor(scfAmount * processingFeeRate / 100);
            const netAmount = scfAmount - processingFee;
            const repaymentAmount = scfAmount + interest;
            
            // Update display with animation
            animateValue(document.getElementById('scfAmountDisplay'), `₹${scfAmount.toLocaleString()}`);
            animateValue(document.getElementById('interestRateDisplay'), `${interestRate}% APR`);
            animateValue(document.getElementById('interestAmount'), `₹${interest.toLocaleString()}`);
            animateValue(document.getElementById('processingFee'), `₹${processingFee.toLocaleString()}`);
            animateValue(document.getElementById('netAmount'), `₹${netAmount.toLocaleString()}`);
            animateValue(document.getElementById('repaymentAmount'), `₹${repaymentAmount.toLocaleString()}`);
            
            // Animate calculation panel
            document.getElementById('calculationPanel').classList.add('updating');
            setTimeout(() => {
                document.getElementById('calculationPanel').classList.remove('updating');
            }, 300);
        }

        // Risk Assessment Update
        function updateRiskAssessment() {
            const creditRiskEl = document.getElementById('creditRisk');
            const marketRiskEl = document.getElementById('marketRisk');
            const recoveryRiskEl = document.getElementById('recoveryRisk');
            
            // Credit risk based on score
            let creditRisk, marketRisk, recoveryRisk;
            
            if (currentCreditScore >= 750) {
                creditRisk = 'LOW';
                creditRiskEl.style.color = '#22c55e';
            } else if (currentCreditScore >= 650) {
                creditRisk = 'MEDIUM';
                creditRiskEl.style.color = '#f59e0b';
            } else {
                creditRisk = 'HIGH';
                creditRiskEl.style.color = '#ef4444';
            }
            
            // Market risk based on cargo type and damage
            const damageRisk = selectedCargo.damage > 50 ? 'HIGH' : selectedCargo.damage > 30 ? 'MEDIUM' : 'LOW';
            marketRisk = damageRisk;
            
            if (damageRisk === 'LOW') {
                marketRiskEl.style.color = '#22c55e';
            } else if (damageRisk === 'MEDIUM') {
                marketRiskEl.style.color = '#f59e0b';
            } else {
                marketRiskEl.style.color = '#ef4444';
            }
            
            // Recovery risk (inverse of damage)
            recoveryRisk = selectedCargo.damage < 30 ? 'HIGH' : selectedCargo.damage < 60 ? 'MEDIUM' : 'LOW';
            
            creditRiskEl.textContent = creditRisk;
            marketRiskEl.textContent = marketRisk;
            recoveryRiskEl.textContent = recoveryRisk;
        }

        // Market Data Updates
        function startMarketUpdates() {
            marketUpdateInterval = setInterval(() => {
                updateMarketData();
            }, 3000);
            
            updateMarketData(); // Initial update
        }

        function updateMarketData() {
            const data = {
                interestRates: (Math.random() * 0.4 + 8.0).toFixed(1) + '%',
                approvalRate: (Math.random() * 6 + 92).toFixed(0) + '%',
                avgProcessing: (Math.random() * 1.5 + 1.8).toFixed(1) + 'h',
                totalSCF: (Math.random() * 3 + 11).toFixed(1) + 'L',
                recoveryRate: (Math.random() * 8 + 84).toFixed(0) + '%',
                activeLoans: Math.floor(Math.random() * 20 + 150)
            };
            
            Object.keys(data).forEach(key => {
                const element = document.getElementById(key);
                if (element && element.textContent !== data[key]) {
                    animateValue(element, data[key]);
                }
            });
        }

        // Credit Monitoring
        function startCreditMonitoring() {
            creditUpdateInterval = setInterval(() => {
                // Small random credit score fluctuations
                if (Math.random() < 0.3) { // 30% chance
                    const currentScore = parseInt(document.getElementById('creditScore').textContent);
                    const variation = Math.floor(Math.random() * 6) - 3; // -3 to +3
                    const newScore = Math.max(300, Math.min(850, currentScore + variation));
                    
                    if (newScore !== currentScore) {
                        currentCreditScore = newScore;
                        animateValue(document.getElementById('creditScore'), newScore);
                        
                        showNotification('📊 Credit Update', `Credit score updated to ${newScore} (${variation > 0 ? '+' : ''}${variation})`);
                    }
                }
            }, 8000);
        }

        // Application Simulation
        function simulatePreApproval() {
            const btn = event.target;
            const originalText = btn.textContent;
            
            btn.disabled = true;
            btn.textContent = '🔍 Checking...';
            
            const statusEl = document.getElementById('statusDisplay');
            const progressEl = document.getElementById('progressFill');
            const messageEl = document.getElementById('approvalMessage');
            
            statusEl.textContent = '🔍 Running Pre-Check...';
            statusEl.className = 'approval-status status-pending';
            
            // Animate progress
            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += Math.random() * 15 + 5;
                progressEl.style.width = Math.min(progress, 100) + '%';
                
                if (progress >= 100) {
                    clearInterval(progressInterval);
                    
                    // Show result
                    setTimeout(() => {
                        const isApproved = currentCreditScore >= 550; // Minimum threshold
                        
                        if (isApproved) {
                            statusEl.textContent = '✅ Pre-Approved!';
                            statusEl.className = 'approval-status status-approved';
                            messageEl.textContent = `Great! You're pre-approved for up to ₹${Math.floor(selectedCargo.value * (creditTiers[currentTier].percentage / 100)).toLocaleString()}. Ready to apply?`;
                            
                            showNotification('✅ Pre-Approval Success', 'You qualify for instant SCF approval!');
                        } else {
                            statusEl.textContent = '❌ Pre-Check Failed';
                            statusEl.className = 'approval-status status-rejected';
                            messageEl.textContent = 'Credit score too low for instant approval. Consider improving credit factors.';
                            
                            showNotification('❌ Pre-Approval Declined', 'Credit score needs improvement for SCF eligibility.');
                        }
                        
                        btn.disabled = false;
                        btn.textContent = originalText;
                        
                        // Reset after 5 seconds
                        setTimeout(() => {
                            progressEl.style.width = '0%';
                            statusEl.textContent = '🔄 Ready for Application';
                            statusEl.className = 'approval-status status-pending';
                            messageEl.textContent = 'Click "Apply for SCF" to start instant processing';
                        }, 5000);
                        
                    }, 1000);
                }
            }, 100);
        }

        function simulateApplication() {
            const btn = document.getElementById('applyBtn');
            const downloadBtn = document.getElementById('downloadBtn');
            const originalText = btn.textContent;
            
            btn.disabled = true;
            btn.textContent = '⏳ Processing...';
            
            const statusEl = document.getElementById('statusDisplay');
            const progressEl = document.getElementById('progressFill');
            const messageEl = document.getElementById('approvalMessage');
            const approvalStatusEl = document.getElementById('approvalStatus');
            
            // Processing stages
            const stages = [
                { text: '🔍 Verifying Identity...', duration: 1000 },
                { text: '📊 Analyzing Credit Score...', duration: 1500 },
                { text: '📦 Assessing Collateral...', duration: 1200 },
                { text: '🏦 Checking Bank Details...', duration: 800 },
                { text: '⚡ Final Approval...', duration: 1000 }
            ];
            
            let currentStage = 0;
            let progress = 0;
            
            function processStage() {
                if (currentStage < stages.length) {
                    const stage = stages[currentStage];
                    statusEl.textContent = stage.text;
                    statusEl.className = 'approval-status status-pending';
                    approvalStatusEl.textContent = 'PROCESSING';
                    
                    // Animate progress for this stage
                    const stageProgress = 100 / stages.length;
                    const startProgress = progress;
                    const endProgress = progress + stageProgress;
                    
                    const stageInterval = setInterval(() => {
                        progress += (endProgress - startProgress) / (stage.duration / 50);
                        progressEl.style.width = Math.min(progress, endProgress) + '%';
                        
                        if (progress >= endProgress) {
                            clearInterval(stageInterval);
                            currentStage++;
                            
                            setTimeout(() => {
                                processStage();
                            }, 200);
                        }
                    }, 50);
                } else {
                    // Final result
                    setTimeout(() => {
                        const isApproved = currentCreditScore >= 550;
                        const scfAmount = document.getElementById('scfAmountDisplay').textContent;
                        const netAmount = document.getElementById('netAmount').textContent;
                        
                        if (isApproved) {
                            statusEl.textContent = '🎉 APPROVED INSTANTLY!';
                            statusEl.className = 'approval-status status-approved';
                            approvalStatusEl.textContent = 'APPROVED';
                            messageEl.innerHTML = `
                                <strong>Congratulations!</strong><br>
                                SCF Amount: ${scfAmount}<br>
                                You Receive: ${netAmount}<br>
                                <small>Funds will be transferred within 2 hours</small>
                            `;
                            
                            btn.style.display = 'none';
                            downloadBtn.style.display = 'inline-flex';
                            
                            showNotification('🎉 SCF APPROVED!', `Instant approval for ${scfAmount}. Funds transferring now!`);
                            
                            // Add to activity (if dashboard is available)
                            setTimeout(() => {
                                showNotification('💰 Funds Transfer', 'SCF funds have been credited to your account!');
                            }, 3000);
                            
                        } else {
                            statusEl.textContent = '❌ Application Declined';
                            statusEl.className = 'approval-status status-rejected';
                            approvalStatusEl.textContent = 'DECLINED';
                            messageEl.textContent = 'Application declined due to credit score requirements. You can reapply after improving your credit profile.';
                            
                            showNotification('❌ Application Declined', 'Credit requirements not met. Please improve credit factors and reapply.');
                        }
                        
                        btn.disabled = false;
                        btn.textContent = originalText;
                        
                    }, 500);
                }
            }
            
            processStage();
        }

        function downloadSCFReport() {
            showNotification('📄 Generating Agreement', 'SCF loan agreement and terms being prepared...');
            
            setTimeout(() => {
                showNotification('📄 Download Complete', 'SCF agreement downloaded successfully. Please review and sign.');
            }, 2000);
        }

        // Utility Functions
        function animateValue(element, newValue) {
            const currentValue = element.textContent;
            if (currentValue !== newValue.toString()) {
                element.style.color = '#22c55e';
                element.style.transform = 'scale(1.05)';
                element.textContent = newValue;
                
                setTimeout(() => {
                    element.style.color = '';
                    element.style.transform = 'scale(1)';
                }, 400);
            }
        }

        function showNotification(title, text) {
            const notification = document.getElementById('notification');
            const titleEl = document.getElementById('notificationTitle');
            const textEl = document.getElementById('notificationText');
            
            titleEl.textContent = title;
            textEl.textContent = text;
            
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 4000);
        }

        // Cleanup
        window.addEventListener('beforeunload', function() {
            clearInterval(marketUpdateInterval);
            clearInterval(creditUpdateInterval);
        });

        // Auto-demo mode (optional)
        function startAutoDemo() {
            const cargos = document.querySelectorAll('.cargo-option');
            let cargoIndex = 0;
            
            setInterval(() => {
                // Switch cargo
                cargos[cargoIndex].click();
                cargoIndex = (cargoIndex + 1) % cargos.length;
                
                // Random credit adjustments
                setTimeout(() => {
                    const sliders = ['paymentHistory', 'businessAge', 'revenue'];
                    const randomSlider = sliders[Math.floor(Math.random() * sliders.length)];
                    const slider = document.getElementById(randomSlider);
                    const range = slider.max - slider.min;
                    slider.value = parseInt(slider.min) + Math.floor(Math.random() * range);
                    updateCreditScore();
                }, 2000);
                
            }, 8000);
        }

        // Uncomment to enable auto-demo
        // setTimeout(startAutoDemo, 10000);
    </script>
</body>
</html>, name: 'Australian Dollar', flag: '🇦🇺' },
            'CAD': { symbol: 'C

        // Credit Tiers Configuration
        const creditTiers = {
            excellent: { 
                min: 750, max: 850, percentage: 65, 
                rates: { 30: 8, 60: 10, 90: 12, 120: 14 }, 
                processingFee: 0.5,
                class: 'score-excellent'
            },
            good: { 
                min: 650, max: 749, percentage: 55, 
                rates: { 30: 10, 60: 12, 90: 14, 120: 16 }, 
                processingFee: 0.75,
                class: 'score-good'
            },
            fair: { 
                min: 550, max: 649, percentage: 45, 
                rates: { 30: 12, 60: 14, 90: 16, 120: 18 }, 
                processingFee: 1.0,
                class: 'score-fair'
            },
            poor: { 
                min: 300, max: 549, percentage: 30, 
                rates: { 30: 15, 60: 17, 90: 19, 120: 22 }, 
                processingFee: 1.5,
                class: 'score-poor'
            }
        };

        // Initialize System
        document.addEventListener('DOMContentLoaded', function() {
            updateCreditScore();
            calculateSCF();
            startMarketUpdates();
            startCreditMonitoring();
            
            // Welcome notification
            setTimeout(() => {
                showNotification('🎉 SCF System Online', 'Live credit assessment and real-time calculations active!');
            }, 1000);
        });

        // Cargo Selection
        function selectCargo(element) {
            document.querySelectorAll('.cargo-option').forEach(option => {
                option.classList.remove('selected');
            });
            element.classList.add('selected');
            
            selectedCargo = {
                value: parseInt(element.dataset.value),
                damage: parseInt(element.dataset.damage),
                type: element.dataset.type
            };
            
            // Update auction value display
            document.getElementById('auctionValue').value = `₹${selectedCargo.value.toLocaleString()}`;
            
            // Update SCF slider max
            const maxSCF = Math.floor(selectedCargo.value * (creditTiers[currentTier].percentage / 100));
            const scfSlider = document.getElementById('scfAmount');
            scfSlider.max = maxSCF;
            
            // Reset to 50% of max eligibility
            const newAmount = Math.floor(maxSCF * 0.75);
            scfSlider.value = newAmount;
            
            updateCreditScore();
            calculateSCF();
            
            showNotification('📦 Cargo Updated', `Selected ${element.querySelector('.cargo-name').textContent} worth ${element.querySelector('.cargo-value').textContent}`);
        }

        // Credit Score Calculation
        function updateCreditScore() {
            const paymentHistory = parseInt(document.getElementById('paymentHistory').value);
            const businessAge = parseInt(document.getElementById('businessAge').value);
            const revenue = parseFloat(document.getElementById('revenue').value);
            
            // Update slider displays
            document.getElementById('paymentValue').textContent = paymentHistory;
            document.getElementById('ageValue').textContent = `${businessAge} Years`;
            document.getElementById('revenueValue').textContent = `₹${revenue} Cr`;
            
            // Calculate composite score
            let score = Math.floor(
                paymentHistory * 0.4 +  // 40% weight
                Math.min(businessAge * 25, 200) +  // Business age factor
                Math.min(revenue * 15, 150) +  // Revenue factor
                Math.random() * 20 - 10  // Small random variation
            );
            
            // Adjust for cargo type risk
            const cargoRiskAdjustment = {
                electronics: -10,
                textiles: 0,
                machinery: -15,
                chemicals: -20
            };
            score += cargoRiskAdjustment[selectedCargo.type] || 0;
            
            // Adjust for damage percentage
            score -= selectedCargo.damage * 0.5;
            
            // Ensure score is within bounds
            score = Math.max(300, Math.min(850, score));
            
            currentCreditScore = score;
            
            // Determine tier
            for (const [tier, config] of Object.entries(creditTiers)) {
                if (score >= config.min && score <= config.max) {
                    currentTier = tier;
                    break;
                }
            }
            
            // Update display with animation
            const scoreCircle = document.getElementById('scoreCircle');
            const scoreElement = document.getElementById('creditScore');
            const tierElement = document.getElementById('scoreTier');
            const rangeElement = document.getElementById('scoreRange');
            const eligibilityPercent = document.getElementById('eligibilityPercent');
            const eligibilityAmount = document.getElementById('eligibilityAmount');
            
            // Animate score change
            animateValue(scoreElement, score);
            
            // Update visual styling
            scoreCircle.className = `score-circle ${creditTiers[currentTier].class}`;
            tierElement.textContent = currentTier.toUpperCase();
            rangeElement.textContent = `${creditTiers[currentTier].min} - ${creditTiers[currentTier].max} Range`;
            
            // Update eligibility
            const percentage = creditTiers[currentTier].percentage;
            const maxAmount = Math.floor(selectedCargo.value * (percentage / 100));
            
            animateValue(eligibilityPercent, `${percentage}%`);
            animateValue(eligibilityAmount, `₹${maxAmount.toLocaleString()}`);
            
            // Update SCF slider max
            const scfSlider = document.getElementById('scfAmount');
            scfSlider.max = maxAmount;
            if (parseInt(scfSlider.value) > maxAmount) {
                scfSlider.value = maxAmount;
            }
            
            // Update risk assessment
            updateRiskAssessment();
            
            // Animate panel
            document.getElementById('creditPanel').classList.add('updating');
            setTimeout(() => {
                document.getElementById('creditPanel').classList.remove('updating');
            }, 500);
            
            // Recalculate SCF
            calculateSCF();
        }

        // SCF Calculation
        function calculateSCF() {
            const scfAmount = parseInt(document.getElementById('scfAmount').value);
            const periodSelect = document.getElementById('repaymentPeriod');
            const period = parseInt(periodSelect.value);
            const rate = parseInt(periodSelect.selectedOptions[0].dataset.rate);
            
            // Update slider display
            document.getElementById('scfValue').textContent = `₹${scfAmount.toLocaleString()}`;
            
            const tier = creditTiers[currentTier];
            const interestRate = tier.rates[period];
            const processingFeeRate = tier.processingFee;
            
            // Calculate amounts
            const interest = Math.floor((scfAmount * interestRate * period) / (365 * 100));
            const processingFee = Math.floor(scfAmount * processingFeeRate / 100);
            const netAmount = scfAmount - processingFee;
            const repaymentAmount = scfAmount + interest;
            
            // Update display with animation
            animateValue(document.getElementById('scfAmountDisplay'), `₹${scfAmount.toLocaleString()}`);
            animateValue(document.getElementById('interestRateDisplay'), `${interestRate}% APR`);
            animateValue(document.getElementById('interestAmount'), `₹${interest.toLocaleString()}`);
            animateValue(document.getElementById('processingFee'), `₹${processingFee.toLocaleString()}`);
            animateValue(document.getElementById('netAmount'), `₹${netAmount.toLocaleString()}`);
            animateValue(document.getElementById('repaymentAmount'), `₹${repaymentAmount.toLocaleString()}`);
            
            // Animate calculation panel
            document.getElementById('calculationPanel').classList.add('updating');
            setTimeout(() => {
                document.getElementById('calculationPanel').classList.remove('updating');
            }, 300);
        }

        // Risk Assessment Update
        function updateRiskAssessment() {
            const creditRiskEl = document.getElementById('creditRisk');
            const marketRiskEl = document.getElementById('marketRisk');
            const recoveryRiskEl = document.getElementById('recoveryRisk');
            
            // Credit risk based on score
            let creditRisk, marketRisk, recoveryRisk;
            
            if (currentCreditScore >= 750) {
                creditRisk = 'LOW';
                creditRiskEl.style.color = '#22c55e';
            } else if (currentCreditScore >= 650) {
                creditRisk = 'MEDIUM';
                creditRiskEl.style.color = '#f59e0b';
            } else {
                creditRisk = 'HIGH';
                creditRiskEl.style.color = '#ef4444';
            }
            
            // Market risk based on cargo type and damage
            const damageRisk = selectedCargo.damage > 50 ? 'HIGH' : selectedCargo.damage > 30 ? 'MEDIUM' : 'LOW';
            marketRisk = damageRisk;
            
            if (damageRisk === 'LOW') {
                marketRiskEl.style.color = '#22c55e';
            } else if (damageRisk === 'MEDIUM') {
                marketRiskEl.style.color = '#f59e0b';
            } else {
                marketRiskEl.style.color = '#ef4444';
            }
            
            // Recovery risk (inverse of damage)
            recoveryRisk = selectedCargo.damage < 30 ? 'HIGH' : selectedCargo.damage < 60 ? 'MEDIUM' : 'LOW';
            
            creditRiskEl.textContent = creditRisk;
            marketRiskEl.textContent = marketRisk;
            recoveryRiskEl.textContent = recoveryRisk;
        }

        // Market Data Updates
        function startMarketUpdates() {
            marketUpdateInterval = setInterval(() => {
                updateMarketData();
            }, 3000);
            
            updateMarketData(); // Initial update
        }

        function updateMarketData() {
            const data = {
                interestRates: (Math.random() * 0.4 + 8.0).toFixed(1) + '%',
                approvalRate: (Math.random() * 6 + 92).toFixed(0) + '%',
                avgProcessing: (Math.random() * 1.5 + 1.8).toFixed(1) + 'h',
                totalSCF: (Math.random() * 3 + 11).toFixed(1) + 'L',
                recoveryRate: (Math.random() * 8 + 84).toFixed(0) + '%',
                activeLoans: Math.floor(Math.random() * 20 + 150)
            };
            
            Object.keys(data).forEach(key => {
                const element = document.getElementById(key);
                if (element && element.textContent !== data[key]) {
                    animateValue(element, data[key]);
                }
            });
        }

        // Credit Monitoring
        function startCreditMonitoring() {
            creditUpdateInterval = setInterval(() => {
                // Small random credit score fluctuations
                if (Math.random() < 0.3) { // 30% chance
                    const currentScore = parseInt(document.getElementById('creditScore').textContent);
                    const variation = Math.floor(Math.random() * 6) - 3; // -3 to +3
                    const newScore = Math.max(300, Math.min(850, currentScore + variation));
                    
                    if (newScore !== currentScore) {
                        currentCreditScore = newScore;
                        animateValue(document.getElementById('creditScore'), newScore);
                        
                        showNotification('📊 Credit Update', `Credit score updated to ${newScore} (${variation > 0 ? '+' : ''}${variation})`);
                    }
                }
            }, 8000);
        }

        // Application Simulation
        function simulatePreApproval() {
            const btn = event.target;
            const originalText = btn.textContent;
            
            btn.disabled = true;
            btn.textContent = '🔍 Checking...';
            
            const statusEl = document.getElementById('statusDisplay');
            const progressEl = document.getElementById('progressFill');
            const messageEl = document.getElementById('approvalMessage');
            
            statusEl.textContent = '🔍 Running Pre-Check...';
            statusEl.className = 'approval-status status-pending';
            
            // Animate progress
            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += Math.random() * 15 + 5;
                progressEl.style.width = Math.min(progress, 100) + '%';
                
                if (progress >= 100) {
                    clearInterval(progressInterval);
                    
                    // Show result
                    setTimeout(() => {
                        const isApproved = currentCreditScore >= 550; // Minimum threshold
                        
                        if (isApproved) {
                            statusEl.textContent = '✅ Pre-Approved!';
                            statusEl.className = 'approval-status status-approved';
                            messageEl.textContent = `Great! You're pre-approved for up to ₹${Math.floor(selectedCargo.value * (creditTiers[currentTier].percentage / 100)).toLocaleString()}. Ready to apply?`;
                            
                            showNotification('✅ Pre-Approval Success', 'You qualify for instant SCF approval!');
                        } else {
                            statusEl.textContent = '❌ Pre-Check Failed';
                            statusEl.className = 'approval-status status-rejected';
                            messageEl.textContent = 'Credit score too low for instant approval. Consider improving credit factors.';
                            
                            showNotification('❌ Pre-Approval Declined', 'Credit score needs improvement for SCF eligibility.');
                        }
                        
                        btn.disabled = false;
                        btn.textContent = originalText;
                        
                        // Reset after 5 seconds
                        setTimeout(() => {
                            progressEl.style.width = '0%';
                            statusEl.textContent = '🔄 Ready for Application';
                            statusEl.className = 'approval-status status-pending';
                            messageEl.textContent = 'Click "Apply for SCF" to start instant processing';
                        }, 5000);
                        
                    }, 1000);
                }
            }, 100);
        }

        function simulateApplication() {
            const btn = document.getElementById('applyBtn');
            const downloadBtn = document.getElementById('downloadBtn');
            const originalText = btn.textContent;
            
            btn.disabled = true;
            btn.textContent = '⏳ Processing...';
            
            const statusEl = document.getElementById('statusDisplay');
            const progressEl = document.getElementById('progressFill');
            const messageEl = document.getElementById('approvalMessage');
            const approvalStatusEl = document.getElementById('approvalStatus');
            
            // Processing stages
            const stages = [
                { text: '🔍 Verifying Identity...', duration: 1000 },
                { text: '📊 Analyzing Credit Score...', duration: 1500 },
                { text: '📦 Assessing Collateral...', duration: 1200 },
                { text: '🏦 Checking Bank Details...', duration: 800 },
                { text: '⚡ Final Approval...', duration: 1000 }
            ];
            
            let currentStage = 0;
            let progress = 0;
            
            function processStage() {
                if (currentStage < stages.length) {
                    const stage = stages[currentStage];
                    statusEl.textContent = stage.text;
                    statusEl.className = 'approval-status status-pending';
                    approvalStatusEl.textContent = 'PROCESSING';
                    
                    // Animate progress for this stage
                    const stageProgress = 100 / stages.length;
                    const startProgress = progress;
                    const endProgress = progress + stageProgress;
                    
                    const stageInterval = setInterval(() => {
                        progress += (endProgress - startProgress) / (stage.duration / 50);
                        progressEl.style.width = Math.min(progress, endProgress) + '%';
                        
                        if (progress >= endProgress) {
                            clearInterval(stageInterval);
                            currentStage++;
                            
                            setTimeout(() => {
                                processStage();
                            }, 200);
                        }
                    }, 50);
                } else {
                    // Final result
                    setTimeout(() => {
                        const isApproved = currentCreditScore >= 550;
                        const scfAmount = document.getElementById('scfAmountDisplay').textContent;
                        const netAmount = document.getElementById('netAmount').textContent;
                        
                        if (isApproved) {
                            statusEl.textContent = '🎉 APPROVED INSTANTLY!';
                            statusEl.className = 'approval-status status-approved';
                            approvalStatusEl.textContent = 'APPROVED';
                            messageEl.innerHTML = `
                                <strong>Congratulations!</strong><br>
                                SCF Amount: ${scfAmount}<br>
                                You Receive: ${netAmount}<br>
                                <small>Funds will be transferred within 2 hours</small>
                            `;
                            
                            btn.style.display = 'none';
                            downloadBtn.style.display = 'inline-flex';
                            
                            showNotification('🎉 SCF APPROVED!', `Instant approval for ${scfAmount}. Funds transferring now!`);
                            
                            // Add to activity (if dashboard is available)
                            setTimeout(() => {
                                showNotification('💰 Funds Transfer', 'SCF funds have been credited to your account!');
                            }, 3000);
                            
                        } else {
                            statusEl.textContent = '❌ Application Declined';
                            statusEl.className = 'approval-status status-rejected';
                            approvalStatusEl.textContent = 'DECLINED';
                            messageEl.textContent = 'Application declined due to credit score requirements. You can reapply after improving your credit profile.';
                            
                            showNotification('❌ Application Declined', 'Credit requirements not met. Please improve credit factors and reapply.');
                        }
                        
                        btn.disabled = false;
                        btn.textContent = originalText;
                        
                    }, 500);
                }
            }
            
            processStage();
        }

        function downloadSCFReport() {
            showNotification('📄 Generating Agreement', 'SCF loan agreement and terms being prepared...');
            
            setTimeout(() => {
                showNotification('📄 Download Complete', 'SCF agreement downloaded successfully. Please review and sign.');
            }, 2000);
        }

        // Utility Functions
        function animateValue(element, newValue) {
            const currentValue = element.textContent;
            if (currentValue !== newValue.toString()) {
                element.style.color = '#22c55e';
                element.style.transform = 'scale(1.05)';
                element.textContent = newValue;
                
                setTimeout(() => {
                    element.style.color = '';
                    element.style.transform = 'scale(1)';
                }, 400);
            }
        }

        function showNotification(title, text) {
            const notification = document.getElementById('notification');
            const titleEl = document.getElementById('notificationTitle');
            const textEl = document.getElementById('notificationText');
            
            titleEl.textContent = title;
            textEl.textContent = text;
            
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 4000);
        }

        // Cleanup
        window.addEventListener('beforeunload', function() {
            clearInterval(marketUpdateInterval);
            clearInterval(creditUpdateInterval);
        });

        // Auto-demo mode (optional)
        function startAutoDemo() {
            const cargos = document.querySelectorAll('.cargo-option');
            let cargoIndex = 0;
            
            setInterval(() => {
                // Switch cargo
                cargos[cargoIndex].click();
                cargoIndex = (cargoIndex + 1) % cargos.length;
                
                // Random credit adjustments
                setTimeout(() => {
                    const sliders = ['paymentHistory', 'businessAge', 'revenue'];
                    const randomSlider = sliders[Math.floor(Math.random() * sliders.length)];
                    const slider = document.getElementById(randomSlider);
                    const range = slider.max - slider.min;
                    slider.value = parseInt(slider.min) + Math.floor(Math.random() * range);
                    updateCreditScore();
                }, 2000);
                
            }, 8000);
        }

        // Uncomment to enable auto-demo
        // setTimeout(startAutoDemo, 10000);
    </script>
</body>
</html>, name: 'Canadian Dollar', flag: '🇨🇦' },
            'CHF': { symbol: 'Fr', name: 'Swiss Franc', flag: '🇨🇭' },
            'SGD': { symbol: 'S

        // Credit Tiers Configuration
        const creditTiers = {
            excellent: { 
                min: 750, max: 850, percentage: 65, 
                rates: { 30: 8, 60: 10, 90: 12, 120: 14 }, 
                processingFee: 0.5,
                class: 'score-excellent'
            },
            good: { 
                min: 650, max: 749, percentage: 55, 
                rates: { 30: 10, 60: 12, 90: 14, 120: 16 }, 
                processingFee: 0.75,
                class: 'score-good'
            },
            fair: { 
                min: 550, max: 649, percentage: 45, 
                rates: { 30: 12, 60: 14, 90: 16, 120: 18 }, 
                processingFee: 1.0,
                class: 'score-fair'
            },
            poor: { 
                min: 300, max: 549, percentage: 30, 
                rates: { 30: 15, 60: 17, 90: 19, 120: 22 }, 
                processingFee: 1.5,
                class: 'score-poor'
            }
        };

        // Initialize System
        document.addEventListener('DOMContentLoaded', function() {
            updateCreditScore();
            calculateSCF();
            startMarketUpdates();
            startCreditMonitoring();
            
            // Welcome notification
            setTimeout(() => {
                showNotification('🎉 SCF System Online', 'Live credit assessment and real-time calculations active!');
            }, 1000);
        });

        // Cargo Selection
        function selectCargo(element) {
            document.querySelectorAll('.cargo-option').forEach(option => {
                option.classList.remove('selected');
            });
            element.classList.add('selected');
            
            selectedCargo = {
                value: parseInt(element.dataset.value),
                damage: parseInt(element.dataset.damage),
                type: element.dataset.type
            };
            
            // Update auction value display
            document.getElementById('auctionValue').value = `₹${selectedCargo.value.toLocaleString()}`;
            
            // Update SCF slider max
            const maxSCF = Math.floor(selectedCargo.value * (creditTiers[currentTier].percentage / 100));
            const scfSlider = document.getElementById('scfAmount');
            scfSlider.max = maxSCF;
            
            // Reset to 50% of max eligibility
            const newAmount = Math.floor(maxSCF * 0.75);
            scfSlider.value = newAmount;
            
            updateCreditScore();
            calculateSCF();
            
            showNotification('📦 Cargo Updated', `Selected ${element.querySelector('.cargo-name').textContent} worth ${element.querySelector('.cargo-value').textContent}`);
        }

        // Credit Score Calculation
        function updateCreditScore() {
            const paymentHistory = parseInt(document.getElementById('paymentHistory').value);
            const businessAge = parseInt(document.getElementById('businessAge').value);
            const revenue = parseFloat(document.getElementById('revenue').value);
            
            // Update slider displays
            document.getElementById('paymentValue').textContent = paymentHistory;
            document.getElementById('ageValue').textContent = `${businessAge} Years`;
            document.getElementById('revenueValue').textContent = `₹${revenue} Cr`;
            
            // Calculate composite score
            let score = Math.floor(
                paymentHistory * 0.4 +  // 40% weight
                Math.min(businessAge * 25, 200) +  // Business age factor
                Math.min(revenue * 15, 150) +  // Revenue factor
                Math.random() * 20 - 10  // Small random variation
            );
            
            // Adjust for cargo type risk
            const cargoRiskAdjustment = {
                electronics: -10,
                textiles: 0,
                machinery: -15,
                chemicals: -20
            };
            score += cargoRiskAdjustment[selectedCargo.type] || 0;
            
            // Adjust for damage percentage
            score -= selectedCargo.damage * 0.5;
            
            // Ensure score is within bounds
            score = Math.max(300, Math.min(850, score));
            
            currentCreditScore = score;
            
            // Determine tier
            for (const [tier, config] of Object.entries(creditTiers)) {
                if (score >= config.min && score <= config.max) {
                    currentTier = tier;
                    break;
                }
            }
            
            // Update display with animation
            const scoreCircle = document.getElementById('scoreCircle');
            const scoreElement = document.getElementById('creditScore');
            const tierElement = document.getElementById('scoreTier');
            const rangeElement = document.getElementById('scoreRange');
            const eligibilityPercent = document.getElementById('eligibilityPercent');
            const eligibilityAmount = document.getElementById('eligibilityAmount');
            
            // Animate score change
            animateValue(scoreElement, score);
            
            // Update visual styling
            scoreCircle.className = `score-circle ${creditTiers[currentTier].class}`;
            tierElement.textContent = currentTier.toUpperCase();
            rangeElement.textContent = `${creditTiers[currentTier].min} - ${creditTiers[currentTier].max} Range`;
            
            // Update eligibility
            const percentage = creditTiers[currentTier].percentage;
            const maxAmount = Math.floor(selectedCargo.value * (percentage / 100));
            
            animateValue(eligibilityPercent, `${percentage}%`);
            animateValue(eligibilityAmount, `₹${maxAmount.toLocaleString()}`);
            
            // Update SCF slider max
            const scfSlider = document.getElementById('scfAmount');
            scfSlider.max = maxAmount;
            if (parseInt(scfSlider.value) > maxAmount) {
                scfSlider.value = maxAmount;
            }
            
            // Update risk assessment
            updateRiskAssessment();
            
            // Animate panel
            document.getElementById('creditPanel').classList.add('updating');
            setTimeout(() => {
                document.getElementById('creditPanel').classList.remove('updating');
            }, 500);
            
            // Recalculate SCF
            calculateSCF();
        }

        // SCF Calculation
        function calculateSCF() {
            const scfAmount = parseInt(document.getElementById('scfAmount').value);
            const periodSelect = document.getElementById('repaymentPeriod');
            const period = parseInt(periodSelect.value);
            const rate = parseInt(periodSelect.selectedOptions[0].dataset.rate);
            
            // Update slider display
            document.getElementById('scfValue').textContent = `₹${scfAmount.toLocaleString()}`;
            
            const tier = creditTiers[currentTier];
            const interestRate = tier.rates[period];
            const processingFeeRate = tier.processingFee;
            
            // Calculate amounts
            const interest = Math.floor((scfAmount * interestRate * period) / (365 * 100));
            const processingFee = Math.floor(scfAmount * processingFeeRate / 100);
            const netAmount = scfAmount - processingFee;
            const repaymentAmount = scfAmount + interest;
            
            // Update display with animation
            animateValue(document.getElementById('scfAmountDisplay'), `₹${scfAmount.toLocaleString()}`);
            animateValue(document.getElementById('interestRateDisplay'), `${interestRate}% APR`);
            animateValue(document.getElementById('interestAmount'), `₹${interest.toLocaleString()}`);
            animateValue(document.getElementById('processingFee'), `₹${processingFee.toLocaleString()}`);
            animateValue(document.getElementById('netAmount'), `₹${netAmount.toLocaleString()}`);
            animateValue(document.getElementById('repaymentAmount'), `₹${repaymentAmount.toLocaleString()}`);
            
            // Animate calculation panel
            document.getElementById('calculationPanel').classList.add('updating');
            setTimeout(() => {
                document.getElementById('calculationPanel').classList.remove('updating');
            }, 300);
        }

        // Risk Assessment Update
        function updateRiskAssessment() {
            const creditRiskEl = document.getElementById('creditRisk');
            const marketRiskEl = document.getElementById('marketRisk');
            const recoveryRiskEl = document.getElementById('recoveryRisk');
            
            // Credit risk based on score
            let creditRisk, marketRisk, recoveryRisk;
            
            if (currentCreditScore >= 750) {
                creditRisk = 'LOW';
                creditRiskEl.style.color = '#22c55e';
            } else if (currentCreditScore >= 650) {
                creditRisk = 'MEDIUM';
                creditRiskEl.style.color = '#f59e0b';
            } else {
                creditRisk = 'HIGH';
                creditRiskEl.style.color = '#ef4444';
            }
            
            // Market risk based on cargo type and damage
            const damageRisk = selectedCargo.damage > 50 ? 'HIGH' : selectedCargo.damage > 30 ? 'MEDIUM' : 'LOW';
            marketRisk = damageRisk;
            
            if (damageRisk === 'LOW') {
                marketRiskEl.style.color = '#22c55e';
            } else if (damageRisk === 'MEDIUM') {
                marketRiskEl.style.color = '#f59e0b';
            } else {
                marketRiskEl.style.color = '#ef4444';
            }
            
            // Recovery risk (inverse of damage)
            recoveryRisk = selectedCargo.damage < 30 ? 'HIGH' : selectedCargo.damage < 60 ? 'MEDIUM' : 'LOW';
            
            creditRiskEl.textContent = creditRisk;
            marketRiskEl.textContent = marketRisk;
            recoveryRiskEl.textContent = recoveryRisk;
        }

        // Market Data Updates
        function startMarketUpdates() {
            marketUpdateInterval = setInterval(() => {
                updateMarketData();
            }, 3000);
            
            updateMarketData(); // Initial update
        }

        function updateMarketData() {
            const data = {
                interestRates: (Math.random() * 0.4 + 8.0).toFixed(1) + '%',
                approvalRate: (Math.random() * 6 + 92).toFixed(0) + '%',
                avgProcessing: (Math.random() * 1.5 + 1.8).toFixed(1) + 'h',
                totalSCF: (Math.random() * 3 + 11).toFixed(1) + 'L',
                recoveryRate: (Math.random() * 8 + 84).toFixed(0) + '%',
                activeLoans: Math.floor(Math.random() * 20 + 150)
            };
            
            Object.keys(data).forEach(key => {
                const element = document.getElementById(key);
                if (element && element.textContent !== data[key]) {
                    animateValue(element, data[key]);
                }
            });
        }

        // Credit Monitoring
        function startCreditMonitoring() {
            creditUpdateInterval = setInterval(() => {
                // Small random credit score fluctuations
                if (Math.random() < 0.3) { // 30% chance
                    const currentScore = parseInt(document.getElementById('creditScore').textContent);
                    const variation = Math.floor(Math.random() * 6) - 3; // -3 to +3
                    const newScore = Math.max(300, Math.min(850, currentScore + variation));
                    
                    if (newScore !== currentScore) {
                        currentCreditScore = newScore;
                        animateValue(document.getElementById('creditScore'), newScore);
                        
                        showNotification('📊 Credit Update', `Credit score updated to ${newScore} (${variation > 0 ? '+' : ''}${variation})`);
                    }
                }
            }, 8000);
        }

        // Application Simulation
        function simulatePreApproval() {
            const btn = event.target;
            const originalText = btn.textContent;
            
            btn.disabled = true;
            btn.textContent = '🔍 Checking...';
            
            const statusEl = document.getElementById('statusDisplay');
            const progressEl = document.getElementById('progressFill');
            const messageEl = document.getElementById('approvalMessage');
            
            statusEl.textContent = '🔍 Running Pre-Check...';
            statusEl.className = 'approval-status status-pending';
            
            // Animate progress
            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += Math.random() * 15 + 5;
                progressEl.style.width = Math.min(progress, 100) + '%';
                
                if (progress >= 100) {
                    clearInterval(progressInterval);
                    
                    // Show result
                    setTimeout(() => {
                        const isApproved = currentCreditScore >= 550; // Minimum threshold
                        
                        if (isApproved) {
                            statusEl.textContent = '✅ Pre-Approved!';
                            statusEl.className = 'approval-status status-approved';
                            messageEl.textContent = `Great! You're pre-approved for up to ₹${Math.floor(selectedCargo.value * (creditTiers[currentTier].percentage / 100)).toLocaleString()}. Ready to apply?`;
                            
                            showNotification('✅ Pre-Approval Success', 'You qualify for instant SCF approval!');
                        } else {
                            statusEl.textContent = '❌ Pre-Check Failed';
                            statusEl.className = 'approval-status status-rejected';
                            messageEl.textContent = 'Credit score too low for instant approval. Consider improving credit factors.';
                            
                            showNotification('❌ Pre-Approval Declined', 'Credit score needs improvement for SCF eligibility.');
                        }
                        
                        btn.disabled = false;
                        btn.textContent = originalText;
                        
                        // Reset after 5 seconds
                        setTimeout(() => {
                            progressEl.style.width = '0%';
                            statusEl.textContent = '🔄 Ready for Application';
                            statusEl.className = 'approval-status status-pending';
                            messageEl.textContent = 'Click "Apply for SCF" to start instant processing';
                        }, 5000);
                        
                    }, 1000);
                }
            }, 100);
        }

        function simulateApplication() {
            const btn = document.getElementById('applyBtn');
            const downloadBtn = document.getElementById('downloadBtn');
            const originalText = btn.textContent;
            
            btn.disabled = true;
            btn.textContent = '⏳ Processing...';
            
            const statusEl = document.getElementById('statusDisplay');
            const progressEl = document.getElementById('progressFill');
            const messageEl = document.getElementById('approvalMessage');
            const approvalStatusEl = document.getElementById('approvalStatus');
            
            // Processing stages
            const stages = [
                { text: '🔍 Verifying Identity...', duration: 1000 },
                { text: '📊 Analyzing Credit Score...', duration: 1500 },
                { text: '📦 Assessing Collateral...', duration: 1200 },
                { text: '🏦 Checking Bank Details...', duration: 800 },
                { text: '⚡ Final Approval...', duration: 1000 }
            ];
            
            let currentStage = 0;
            let progress = 0;
            
            function processStage() {
                if (currentStage < stages.length) {
                    const stage = stages[currentStage];
                    statusEl.textContent = stage.text;
                    statusEl.className = 'approval-status status-pending';
                    approvalStatusEl.textContent = 'PROCESSING';
                    
                    // Animate progress for this stage
                    const stageProgress = 100 / stages.length;
                    const startProgress = progress;
                    const endProgress = progress + stageProgress;
                    
                    const stageInterval = setInterval(() => {
                        progress += (endProgress - startProgress) / (stage.duration / 50);
                        progressEl.style.width = Math.min(progress, endProgress) + '%';
                        
                        if (progress >= endProgress) {
                            clearInterval(stageInterval);
                            currentStage++;
                            
                            setTimeout(() => {
                                processStage();
                            }, 200);
                        }
                    }, 50);
                } else {
                    // Final result
                    setTimeout(() => {
                        const isApproved = currentCreditScore >= 550;
                        const scfAmount = document.getElementById('scfAmountDisplay').textContent;
                        const netAmount = document.getElementById('netAmount').textContent;
                        
                        if (isApproved) {
                            statusEl.textContent = '🎉 APPROVED INSTANTLY!';
                            statusEl.className = 'approval-status status-approved';
                            approvalStatusEl.textContent = 'APPROVED';
                            messageEl.innerHTML = `
                                <strong>Congratulations!</strong><br>
                                SCF Amount: ${scfAmount}<br>
                                You Receive: ${netAmount}<br>
                                <small>Funds will be transferred within 2 hours</small>
                            `;
                            
                            btn.style.display = 'none';
                            downloadBtn.style.display = 'inline-flex';
                            
                            showNotification('🎉 SCF APPROVED!', `Instant approval for ${scfAmount}. Funds transferring now!`);
                            
                            // Add to activity (if dashboard is available)
                            setTimeout(() => {
                                showNotification('💰 Funds Transfer', 'SCF funds have been credited to your account!');
                            }, 3000);
                            
                        } else {
                            statusEl.textContent = '❌ Application Declined';
                            statusEl.className = 'approval-status status-rejected';
                            approvalStatusEl.textContent = 'DECLINED';
                            messageEl.textContent = 'Application declined due to credit score requirements. You can reapply after improving your credit profile.';
                            
                            showNotification('❌ Application Declined', 'Credit requirements not met. Please improve credit factors and reapply.');
                        }
                        
                        btn.disabled = false;
                        btn.textContent = originalText;
                        
                    }, 500);
                }
            }
            
            processStage();
        }

        function downloadSCFReport() {
            showNotification('📄 Generating Agreement', 'SCF loan agreement and terms being prepared...');
            
            setTimeout(() => {
                showNotification('📄 Download Complete', 'SCF agreement downloaded successfully. Please review and sign.');
            }, 2000);
        }

        // Utility Functions
        function animateValue(element, newValue) {
            const currentValue = element.textContent;
            if (currentValue !== newValue.toString()) {
                element.style.color = '#22c55e';
                element.style.transform = 'scale(1.05)';
                element.textContent = newValue;
                
                setTimeout(() => {
                    element.style.color = '';
                    element.style.transform = 'scale(1)';
                }, 400);
            }
        }

        function showNotification(title, text) {
            const notification = document.getElementById('notification');
            const titleEl = document.getElementById('notificationTitle');
            const textEl = document.getElementById('notificationText');
            
            titleEl.textContent = title;
            textEl.textContent = text;
            
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 4000);
        }

        // Cleanup
        window.addEventListener('beforeunload', function() {
            clearInterval(marketUpdateInterval);
            clearInterval(creditUpdateInterval);
        });

        // Auto-demo mode (optional)
        function startAutoDemo() {
            const cargos = document.querySelectorAll('.cargo-option');
            let cargoIndex = 0;
            
            setInterval(() => {
                // Switch cargo
                cargos[cargoIndex].click();
                cargoIndex = (cargoIndex + 1) % cargos.length;
                
                // Random credit adjustments
                setTimeout(() => {
                    const sliders = ['paymentHistory', 'businessAge', 'revenue'];
                    const randomSlider = sliders[Math.floor(Math.random() * sliders.length)];
                    const slider = document.getElementById(randomSlider);
                    const range = slider.max - slider.min;
                    slider.value = parseInt(slider.min) + Math.floor(Math.random() * range);
                    updateCreditScore();
                }, 2000);
                
            }, 8000);
        }

        // Uncomment to enable auto-demo
        // setTimeout(startAutoDemo, 10000);
    </script>
</body>
</html>, name: 'Singapore Dollar', flag: '🇸🇬' },
            'HKD': { symbol: 'HK

        // Credit Tiers Configuration
        const creditTiers = {
            excellent: { 
                min: 750, max: 850, percentage: 65, 
                rates: { 30: 8, 60: 10, 90: 12, 120: 14 }, 
                processingFee: 0.5,
                class: 'score-excellent'
            },
            good: { 
                min: 650, max: 749, percentage: 55, 
                rates: { 30: 10, 60: 12, 90: 14, 120: 16 }, 
                processingFee: 0.75,
                class: 'score-good'
            },
            fair: { 
                min: 550, max: 649, percentage: 45, 
                rates: { 30: 12, 60: 14, 90: 16, 120: 18 }, 
                processingFee: 1.0,
                class: 'score-fair'
            },
            poor: { 
                min: 300, max: 549, percentage: 30, 
                rates: { 30: 15, 60: 17, 90: 19, 120: 22 }, 
                processingFee: 1.5,
                class: 'score-poor'
            }
        };

        // Initialize System
        document.addEventListener('DOMContentLoaded', function() {
            updateCreditScore();
            calculateSCF();
            startMarketUpdates();
            startCreditMonitoring();
            
            // Welcome notification
            setTimeout(() => {
                showNotification('🎉 SCF System Online', 'Live credit assessment and real-time calculations active!');
            }, 1000);
        });

        // Cargo Selection
        function selectCargo(element) {
            document.querySelectorAll('.cargo-option').forEach(option => {
                option.classList.remove('selected');
            });
            element.classList.add('selected');
            
            selectedCargo = {
                value: parseInt(element.dataset.value),
                damage: parseInt(element.dataset.damage),
                type: element.dataset.type
            };
            
            // Update auction value display
            document.getElementById('auctionValue').value = `₹${selectedCargo.value.toLocaleString()}`;
            
            // Update SCF slider max
            const maxSCF = Math.floor(selectedCargo.value * (creditTiers[currentTier].percentage / 100));
            const scfSlider = document.getElementById('scfAmount');
            scfSlider.max = maxSCF;
            
            // Reset to 50% of max eligibility
            const newAmount = Math.floor(maxSCF * 0.75);
            scfSlider.value = newAmount;
            
            updateCreditScore();
            calculateSCF();
            
            showNotification('📦 Cargo Updated', `Selected ${element.querySelector('.cargo-name').textContent} worth ${element.querySelector('.cargo-value').textContent}`);
        }

        // Credit Score Calculation
        function updateCreditScore() {
            const paymentHistory = parseInt(document.getElementById('paymentHistory').value);
            const businessAge = parseInt(document.getElementById('businessAge').value);
            const revenue = parseFloat(document.getElementById('revenue').value);
            
            // Update slider displays
            document.getElementById('paymentValue').textContent = paymentHistory;
            document.getElementById('ageValue').textContent = `${businessAge} Years`;
            document.getElementById('revenueValue').textContent = `₹${revenue} Cr`;
            
            // Calculate composite score
            let score = Math.floor(
                paymentHistory * 0.4 +  // 40% weight
                Math.min(businessAge * 25, 200) +  // Business age factor
                Math.min(revenue * 15, 150) +  // Revenue factor
                Math.random() * 20 - 10  // Small random variation
            );
            
            // Adjust for cargo type risk
            const cargoRiskAdjustment = {
                electronics: -10,
                textiles: 0,
                machinery: -15,
                chemicals: -20
            };
            score += cargoRiskAdjustment[selectedCargo.type] || 0;
            
            // Adjust for damage percentage
            score -= selectedCargo.damage * 0.5;
            
            // Ensure score is within bounds
            score = Math.max(300, Math.min(850, score));
            
            currentCreditScore = score;
            
            // Determine tier
            for (const [tier, config] of Object.entries(creditTiers)) {
                if (score >= config.min && score <= config.max) {
                    currentTier = tier;
                    break;
                }
            }
            
            // Update display with animation
            const scoreCircle = document.getElementById('scoreCircle');
            const scoreElement = document.getElementById('creditScore');
            const tierElement = document.getElementById('scoreTier');
            const rangeElement = document.getElementById('scoreRange');
            const eligibilityPercent = document.getElementById('eligibilityPercent');
            const eligibilityAmount = document.getElementById('eligibilityAmount');
            
            // Animate score change
            animateValue(scoreElement, score);
            
            // Update visual styling
            scoreCircle.className = `score-circle ${creditTiers[currentTier].class}`;
            tierElement.textContent = currentTier.toUpperCase();
            rangeElement.textContent = `${creditTiers[currentTier].min} - ${creditTiers[currentTier].max} Range`;
            
            // Update eligibility
            const percentage = creditTiers[currentTier].percentage;
            const maxAmount = Math.floor(selectedCargo.value * (percentage / 100));
            
            animateValue(eligibilityPercent, `${percentage}%`);
            animateValue(eligibilityAmount, `₹${maxAmount.toLocaleString()}`);
            
            // Update SCF slider max
            const scfSlider = document.getElementById('scfAmount');
            scfSlider.max = maxAmount;
            if (parseInt(scfSlider.value) > maxAmount) {
                scfSlider.value = maxAmount;
            }
            
            // Update risk assessment
            updateRiskAssessment();
            
            // Animate panel
            document.getElementById('creditPanel').classList.add('updating');
            setTimeout(() => {
                document.getElementById('creditPanel').classList.remove('updating');
            }, 500);
            
            // Recalculate SCF
            calculateSCF();
        }

        // SCF Calculation
        function calculateSCF() {
            const scfAmount = parseInt(document.getElementById('scfAmount').value);
            const periodSelect = document.getElementById('repaymentPeriod');
            const period = parseInt(periodSelect.value);
            const rate = parseInt(periodSelect.selectedOptions[0].dataset.rate);
            
            // Update slider display
            document.getElementById('scfValue').textContent = `₹${scfAmount.toLocaleString()}`;
            
            const tier = creditTiers[currentTier];
            const interestRate = tier.rates[period];
            const processingFeeRate = tier.processingFee;
            
            // Calculate amounts
            const interest = Math.floor((scfAmount * interestRate * period) / (365 * 100));
            const processingFee = Math.floor(scfAmount * processingFeeRate / 100);
            const netAmount = scfAmount - processingFee;
            const repaymentAmount = scfAmount + interest;
            
            // Update display with animation
            animateValue(document.getElementById('scfAmountDisplay'), `₹${scfAmount.toLocaleString()}`);
            animateValue(document.getElementById('interestRateDisplay'), `${interestRate}% APR`);
            animateValue(document.getElementById('interestAmount'), `₹${interest.toLocaleString()}`);
            animateValue(document.getElementById('processingFee'), `₹${processingFee.toLocaleString()}`);
            animateValue(document.getElementById('netAmount'), `₹${netAmount.toLocaleString()}`);
            animateValue(document.getElementById('repaymentAmount'), `₹${repaymentAmount.toLocaleString()}`);
            
            // Animate calculation panel
            document.getElementById('calculationPanel').classList.add('updating');
            setTimeout(() => {
                document.getElementById('calculationPanel').classList.remove('updating');
            }, 300);
        }

        // Risk Assessment Update
        function updateRiskAssessment() {
            const creditRiskEl = document.getElementById('creditRisk');
            const marketRiskEl = document.getElementById('marketRisk');
            const recoveryRiskEl = document.getElementById('recoveryRisk');
            
            // Credit risk based on score
            let creditRisk, marketRisk, recoveryRisk;
            
            if (currentCreditScore >= 750) {
                creditRisk = 'LOW';
                creditRiskEl.style.color = '#22c55e';
            } else if (currentCreditScore >= 650) {
                creditRisk = 'MEDIUM';
                creditRiskEl.style.color = '#f59e0b';
            } else {
                creditRisk = 'HIGH';
                creditRiskEl.style.color = '#ef4444';
            }
            
            // Market risk based on cargo type and damage
            const damageRisk = selectedCargo.damage > 50 ? 'HIGH' : selectedCargo.damage > 30 ? 'MEDIUM' : 'LOW';
            marketRisk = damageRisk;
            
            if (damageRisk === 'LOW') {
                marketRiskEl.style.color = '#22c55e';
            } else if (damageRisk === 'MEDIUM') {
                marketRiskEl.style.color = '#f59e0b';
            } else {
                marketRiskEl.style.color = '#ef4444';
            }
            
            // Recovery risk (inverse of damage)
            recoveryRisk = selectedCargo.damage < 30 ? 'HIGH' : selectedCargo.damage < 60 ? 'MEDIUM' : 'LOW';
            
            creditRiskEl.textContent = creditRisk;
            marketRiskEl.textContent = marketRisk;
            recoveryRiskEl.textContent = recoveryRisk;
        }

        // Market Data Updates
        function startMarketUpdates() {
            marketUpdateInterval = setInterval(() => {
                updateMarketData();
            }, 3000);
            
            updateMarketData(); // Initial update
        }

        function updateMarketData() {
            const data = {
                interestRates: (Math.random() * 0.4 + 8.0).toFixed(1) + '%',
                approvalRate: (Math.random() * 6 + 92).toFixed(0) + '%',
                avgProcessing: (Math.random() * 1.5 + 1.8).toFixed(1) + 'h',
                totalSCF: (Math.random() * 3 + 11).toFixed(1) + 'L',
                recoveryRate: (Math.random() * 8 + 84).toFixed(0) + '%',
                activeLoans: Math.floor(Math.random() * 20 + 150)
            };
            
            Object.keys(data).forEach(key => {
                const element = document.getElementById(key);
                if (element && element.textContent !== data[key]) {
                    animateValue(element, data[key]);
                }
            });
        }

        // Credit Monitoring
        function startCreditMonitoring() {
            creditUpdateInterval = setInterval(() => {
                // Small random credit score fluctuations
                if (Math.random() < 0.3) { // 30% chance
                    const currentScore = parseInt(document.getElementById('creditScore').textContent);
                    const variation = Math.floor(Math.random() * 6) - 3; // -3 to +3
                    const newScore = Math.max(300, Math.min(850, currentScore + variation));
                    
                    if (newScore !== currentScore) {
                        currentCreditScore = newScore;
                        animateValue(document.getElementById('creditScore'), newScore);
                        
                        showNotification('📊 Credit Update', `Credit score updated to ${newScore} (${variation > 0 ? '+' : ''}${variation})`);
                    }
                }
            }, 8000);
        }

        // Application Simulation
        function simulatePreApproval() {
            const btn = event.target;
            const originalText = btn.textContent;
            
            btn.disabled = true;
            btn.textContent = '🔍 Checking...';
            
            const statusEl = document.getElementById('statusDisplay');
            const progressEl = document.getElementById('progressFill');
            const messageEl = document.getElementById('approvalMessage');
            
            statusEl.textContent = '🔍 Running Pre-Check...';
            statusEl.className = 'approval-status status-pending';
            
            // Animate progress
            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += Math.random() * 15 + 5;
                progressEl.style.width = Math.min(progress, 100) + '%';
                
                if (progress >= 100) {
                    clearInterval(progressInterval);
                    
                    // Show result
                    setTimeout(() => {
                        const isApproved = currentCreditScore >= 550; // Minimum threshold
                        
                        if (isApproved) {
                            statusEl.textContent = '✅ Pre-Approved!';
                            statusEl.className = 'approval-status status-approved';
                            messageEl.textContent = `Great! You're pre-approved for up to ₹${Math.floor(selectedCargo.value * (creditTiers[currentTier].percentage / 100)).toLocaleString()}. Ready to apply?`;
                            
                            showNotification('✅ Pre-Approval Success', 'You qualify for instant SCF approval!');
                        } else {
                            statusEl.textContent = '❌ Pre-Check Failed';
                            statusEl.className = 'approval-status status-rejected';
                            messageEl.textContent = 'Credit score too low for instant approval. Consider improving credit factors.';
                            
                            showNotification('❌ Pre-Approval Declined', 'Credit score needs improvement for SCF eligibility.');
                        }
                        
                        btn.disabled = false;
                        btn.textContent = originalText;
                        
                        // Reset after 5 seconds
                        setTimeout(() => {
                            progressEl.style.width = '0%';
                            statusEl.textContent = '🔄 Ready for Application';
                            statusEl.className = 'approval-status status-pending';
                            messageEl.textContent = 'Click "Apply for SCF" to start instant processing';
                        }, 5000);
                        
                    }, 1000);
                }
            }, 100);
        }

        function simulateApplication() {
            const btn = document.getElementById('applyBtn');
            const downloadBtn = document.getElementById('downloadBtn');
            const originalText = btn.textContent;
            
            btn.disabled = true;
            btn.textContent = '⏳ Processing...';
            
            const statusEl = document.getElementById('statusDisplay');
            const progressEl = document.getElementById('progressFill');
            const messageEl = document.getElementById('approvalMessage');
            const approvalStatusEl = document.getElementById('approvalStatus');
            
            // Processing stages
            const stages = [
                { text: '🔍 Verifying Identity...', duration: 1000 },
                { text: '📊 Analyzing Credit Score...', duration: 1500 },
                { text: '📦 Assessing Collateral...', duration: 1200 },
                { text: '🏦 Checking Bank Details...', duration: 800 },
                { text: '⚡ Final Approval...', duration: 1000 }
            ];
            
            let currentStage = 0;
            let progress = 0;
            
            function processStage() {
                if (currentStage < stages.length) {
                    const stage = stages[currentStage];
                    statusEl.textContent = stage.text;
                    statusEl.className = 'approval-status status-pending';
                    approvalStatusEl.textContent = 'PROCESSING';
                    
                    // Animate progress for this stage
                    const stageProgress = 100 / stages.length;
                    const startProgress = progress;
                    const endProgress = progress + stageProgress;
                    
                    const stageInterval = setInterval(() => {
                        progress += (endProgress - startProgress) / (stage.duration / 50);
                        progressEl.style.width = Math.min(progress, endProgress) + '%';
                        
                        if (progress >= endProgress) {
                            clearInterval(stageInterval);
                            currentStage++;
                            
                            setTimeout(() => {
                                processStage();
                            }, 200);
                        }
                    }, 50);
                } else {
                    // Final result
                    setTimeout(() => {
                        const isApproved = currentCreditScore >= 550;
                        const scfAmount = document.getElementById('scfAmountDisplay').textContent;
                        const netAmount = document.getElementById('netAmount').textContent;
                        
                        if (isApproved) {
                            statusEl.textContent = '🎉 APPROVED INSTANTLY!';
                            statusEl.className = 'approval-status status-approved';
                            approvalStatusEl.textContent = 'APPROVED';
                            messageEl.innerHTML = `
                                <strong>Congratulations!</strong><br>
                                SCF Amount: ${scfAmount}<br>
                                You Receive: ${netAmount}<br>
                                <small>Funds will be transferred within 2 hours</small>
                            `;
                            
                            btn.style.display = 'none';
                            downloadBtn.style.display = 'inline-flex';
                            
                            showNotification('🎉 SCF APPROVED!', `Instant approval for ${scfAmount}. Funds transferring now!`);
                            
                            // Add to activity (if dashboard is available)
                            setTimeout(() => {
                                showNotification('💰 Funds Transfer', 'SCF funds have been credited to your account!');
                            }, 3000);
                            
                        } else {
                            statusEl.textContent = '❌ Application Declined';
                            statusEl.className = 'approval-status status-rejected';
                            approvalStatusEl.textContent = 'DECLINED';
                            messageEl.textContent = 'Application declined due to credit score requirements. You can reapply after improving your credit profile.';
                            
                            showNotification('❌ Application Declined', 'Credit requirements not met. Please improve credit factors and reapply.');
                        }
                        
                        btn.disabled = false;
                        btn.textContent = originalText;
                        
                    }, 500);
                }
            }
            
            processStage();
        }

        function downloadSCFReport() {
            showNotification('📄 Generating Agreement', 'SCF loan agreement and terms being prepared...');
            
            setTimeout(() => {
                showNotification('📄 Download Complete', 'SCF agreement downloaded successfully. Please review and sign.');
            }, 2000);
        }

        // Utility Functions
        function animateValue(element, newValue) {
            const currentValue = element.textContent;
            if (currentValue !== newValue.toString()) {
                element.style.color = '#22c55e';
                element.style.transform = 'scale(1.05)';
                element.textContent = newValue;
                
                setTimeout(() => {
                    element.style.color = '';
                    element.style.transform = 'scale(1)';
                }, 400);
            }
        }

        function showNotification(title, text) {
            const notification = document.getElementById('notification');
            const titleEl = document.getElementById('notificationTitle');
            const textEl = document.getElementById('notificationText');
            
            titleEl.textContent = title;
            textEl.textContent = text;
            
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 4000);
        }

        // Cleanup
        window.addEventListener('beforeunload', function() {
            clearInterval(marketUpdateInterval);
            clearInterval(creditUpdateInterval);
        });

        // Auto-demo mode (optional)
        function startAutoDemo() {
            const cargos = document.querySelectorAll('.cargo-option');
            let cargoIndex = 0;
            
            setInterval(() => {
                // Switch cargo
                cargos[cargoIndex].click();
                cargoIndex = (cargoIndex + 1) % cargos.length;
                
                // Random credit adjustments
                setTimeout(() => {
                    const sliders = ['paymentHistory', 'businessAge', 'revenue'];
                    const randomSlider = sliders[Math.floor(Math.random() * sliders.length)];
                    const slider = document.getElementById(randomSlider);
                    const range = slider.max - slider.min;
                    slider.value = parseInt(slider.min) + Math.floor(Math.random() * range);
                    updateCreditScore();
                }, 2000);
                
            }, 8000);
        }

        // Uncomment to enable auto-demo
        // setTimeout(startAutoDemo, 10000);
    </script>
</body>
</html>, name: 'Hong Kong Dollar', flag: '🇭🇰' },
            'AED': { symbol: 'د.إ', name: 'UAE Dirham', flag: '🇦🇪' },
            'SAR': { symbol: 'ر.س', name: 'Saudi Riyal', flag: '🇸🇦' },
            'KRW': { symbol: '₩', name: 'Korean Won', flag: '🇰🇷' },
            'BRL': { symbol: 'R

        // Credit Tiers Configuration
        const creditTiers = {
            excellent: { 
                min: 750, max: 850, percentage: 65, 
                rates: { 30: 8, 60: 10, 90: 12, 120: 14 }, 
                processingFee: 0.5,
                class: 'score-excellent'
            },
            good: { 
                min: 650, max: 749, percentage: 55, 
                rates: { 30: 10, 60: 12, 90: 14, 120: 16 }, 
                processingFee: 0.75,
                class: 'score-good'
            },
            fair: { 
                min: 550, max: 649, percentage: 45, 
                rates: { 30: 12, 60: 14, 90: 16, 120: 18 }, 
                processingFee: 1.0,
                class: 'score-fair'
            },
            poor: { 
                min: 300, max: 549, percentage: 30, 
                rates: { 30: 15, 60: 17, 90: 19, 120: 22 }, 
                processingFee: 1.5,
                class: 'score-poor'
            }
        };

        // Initialize System
        document.addEventListener('DOMContentLoaded', function() {
            updateCreditScore();
            calculateSCF();
            startMarketUpdates();
            startCreditMonitoring();
            
            // Welcome notification
            setTimeout(() => {
                showNotification('🎉 SCF System Online', 'Live credit assessment and real-time calculations active!');
            }, 1000);
        });

        // Cargo Selection
        function selectCargo(element) {
            document.querySelectorAll('.cargo-option').forEach(option => {
                option.classList.remove('selected');
            });
            element.classList.add('selected');
            
            selectedCargo = {
                value: parseInt(element.dataset.value),
                damage: parseInt(element.dataset.damage),
                type: element.dataset.type
            };
            
            // Update auction value display
            document.getElementById('auctionValue').value = `₹${selectedCargo.value.toLocaleString()}`;
            
            // Update SCF slider max
            const maxSCF = Math.floor(selectedCargo.value * (creditTiers[currentTier].percentage / 100));
            const scfSlider = document.getElementById('scfAmount');
            scfSlider.max = maxSCF;
            
            // Reset to 50% of max eligibility
            const newAmount = Math.floor(maxSCF * 0.75);
            scfSlider.value = newAmount;
            
            updateCreditScore();
            calculateSCF();
            
            showNotification('📦 Cargo Updated', `Selected ${element.querySelector('.cargo-name').textContent} worth ${element.querySelector('.cargo-value').textContent}`);
        }

        // Credit Score Calculation
        function updateCreditScore() {
            const paymentHistory = parseInt(document.getElementById('paymentHistory').value);
            const businessAge = parseInt(document.getElementById('businessAge').value);
            const revenue = parseFloat(document.getElementById('revenue').value);
            
            // Update slider displays
            document.getElementById('paymentValue').textContent = paymentHistory;
            document.getElementById('ageValue').textContent = `${businessAge} Years`;
            document.getElementById('revenueValue').textContent = `₹${revenue} Cr`;
            
            // Calculate composite score
            let score = Math.floor(
                paymentHistory * 0.4 +  // 40% weight
                Math.min(businessAge * 25, 200) +  // Business age factor
                Math.min(revenue * 15, 150) +  // Revenue factor
                Math.random() * 20 - 10  // Small random variation
            );
            
            // Adjust for cargo type risk
            const cargoRiskAdjustment = {
                electronics: -10,
                textiles: 0,
                machinery: -15,
                chemicals: -20
            };
            score += cargoRiskAdjustment[selectedCargo.type] || 0;
            
            // Adjust for damage percentage
            score -= selectedCargo.damage * 0.5;
            
            // Ensure score is within bounds
            score = Math.max(300, Math.min(850, score));
            
            currentCreditScore = score;
            
            // Determine tier
            for (const [tier, config] of Object.entries(creditTiers)) {
                if (score >= config.min && score <= config.max) {
                    currentTier = tier;
                    break;
                }
            }
            
            // Update display with animation
            const scoreCircle = document.getElementById('scoreCircle');
            const scoreElement = document.getElementById('creditScore');
            const tierElement = document.getElementById('scoreTier');
            const rangeElement = document.getElementById('scoreRange');
            const eligibilityPercent = document.getElementById('eligibilityPercent');
            const eligibilityAmount = document.getElementById('eligibilityAmount');
            
            // Animate score change
            animateValue(scoreElement, score);
            
            // Update visual styling
            scoreCircle.className = `score-circle ${creditTiers[currentTier].class}`;
            tierElement.textContent = currentTier.toUpperCase();
            rangeElement.textContent = `${creditTiers[currentTier].min} - ${creditTiers[currentTier].max} Range`;
            
            // Update eligibility
            const percentage = creditTiers[currentTier].percentage;
            const maxAmount = Math.floor(selectedCargo.value * (percentage / 100));
            
            animateValue(eligibilityPercent, `${percentage}%`);
            animateValue(eligibilityAmount, `₹${maxAmount.toLocaleString()}`);
            
            // Update SCF slider max
            const scfSlider = document.getElementById('scfAmount');
            scfSlider.max = maxAmount;
            if (parseInt(scfSlider.value) > maxAmount) {
                scfSlider.value = maxAmount;
            }
            
            // Update risk assessment
            updateRiskAssessment();
            
            // Animate panel
            document.getElementById('creditPanel').classList.add('updating');
            setTimeout(() => {
                document.getElementById('creditPanel').classList.remove('updating');
            }, 500);
            
            // Recalculate SCF
            calculateSCF();
        }

        // SCF Calculation
        function calculateSCF() {
            const scfAmount = parseInt(document.getElementById('scfAmount').value);
            const periodSelect = document.getElementById('repaymentPeriod');
            const period = parseInt(periodSelect.value);
            const rate = parseInt(periodSelect.selectedOptions[0].dataset.rate);
            
            // Update slider display
            document.getElementById('scfValue').textContent = `₹${scfAmount.toLocaleString()}`;
            
            const tier = creditTiers[currentTier];
            const interestRate = tier.rates[period];
            const processingFeeRate = tier.processingFee;
            
            // Calculate amounts
            const interest = Math.floor((scfAmount * interestRate * period) / (365 * 100));
            const processingFee = Math.floor(scfAmount * processingFeeRate / 100);
            const netAmount = scfAmount - processingFee;
            const repaymentAmount = scfAmount + interest;
            
            // Update display with animation
            animateValue(document.getElementById('scfAmountDisplay'), `₹${scfAmount.toLocaleString()}`);
            animateValue(document.getElementById('interestRateDisplay'), `${interestRate}% APR`);
            animateValue(document.getElementById('interestAmount'), `₹${interest.toLocaleString()}`);
            animateValue(document.getElementById('processingFee'), `₹${processingFee.toLocaleString()}`);
            animateValue(document.getElementById('netAmount'), `₹${netAmount.toLocaleString()}`);
            animateValue(document.getElementById('repaymentAmount'), `₹${repaymentAmount.toLocaleString()}`);
            
            // Animate calculation panel
            document.getElementById('calculationPanel').classList.add('updating');
            setTimeout(() => {
                document.getElementById('calculationPanel').classList.remove('updating');
            }, 300);
        }

        // Risk Assessment Update
        function updateRiskAssessment() {
            const creditRiskEl = document.getElementById('creditRisk');
            const marketRiskEl = document.getElementById('marketRisk');
            const recoveryRiskEl = document.getElementById('recoveryRisk');
            
            // Credit risk based on score
            let creditRisk, marketRisk, recoveryRisk;
            
            if (currentCreditScore >= 750) {
                creditRisk = 'LOW';
                creditRiskEl.style.color = '#22c55e';
            } else if (currentCreditScore >= 650) {
                creditRisk = 'MEDIUM';
                creditRiskEl.style.color = '#f59e0b';
            } else {
                creditRisk = 'HIGH';
                creditRiskEl.style.color = '#ef4444';
            }
            
            // Market risk based on cargo type and damage
            const damageRisk = selectedCargo.damage > 50 ? 'HIGH' : selectedCargo.damage > 30 ? 'MEDIUM' : 'LOW';
            marketRisk = damageRisk;
            
            if (damageRisk === 'LOW') {
                marketRiskEl.style.color = '#22c55e';
            } else if (damageRisk === 'MEDIUM') {
                marketRiskEl.style.color = '#f59e0b';
            } else {
                marketRiskEl.style.color = '#ef4444';
            }
            
            // Recovery risk (inverse of damage)
            recoveryRisk = selectedCargo.damage < 30 ? 'HIGH' : selectedCargo.damage < 60 ? 'MEDIUM' : 'LOW';
            
            creditRiskEl.textContent = creditRisk;
            marketRiskEl.textContent = marketRisk;
            recoveryRiskEl.textContent = recoveryRisk;
        }

        // Market Data Updates
        function startMarketUpdates() {
            marketUpdateInterval = setInterval(() => {
                updateMarketData();
            }, 3000);
            
            updateMarketData(); // Initial update
        }

        function updateMarketData() {
            const data = {
                interestRates: (Math.random() * 0.4 + 8.0).toFixed(1) + '%',
                approvalRate: (Math.random() * 6 + 92).toFixed(0) + '%',
                avgProcessing: (Math.random() * 1.5 + 1.8).toFixed(1) + 'h',
                totalSCF: (Math.random() * 3 + 11).toFixed(1) + 'L',
                recoveryRate: (Math.random() * 8 + 84).toFixed(0) + '%',
                activeLoans: Math.floor(Math.random() * 20 + 150)
            };
            
            Object.keys(data).forEach(key => {
                const element = document.getElementById(key);
                if (element && element.textContent !== data[key]) {
                    animateValue(element, data[key]);
                }
            });
        }

        // Credit Monitoring
        function startCreditMonitoring() {
            creditUpdateInterval = setInterval(() => {
                // Small random credit score fluctuations
                if (Math.random() < 0.3) { // 30% chance
                    const currentScore = parseInt(document.getElementById('creditScore').textContent);
                    const variation = Math.floor(Math.random() * 6) - 3; // -3 to +3
                    const newScore = Math.max(300, Math.min(850, currentScore + variation));
                    
                    if (newScore !== currentScore) {
                        currentCreditScore = newScore;
                        animateValue(document.getElementById('creditScore'), newScore);
                        
                        showNotification('📊 Credit Update', `Credit score updated to ${newScore} (${variation > 0 ? '+' : ''}${variation})`);
                    }
                }
            }, 8000);
        }

        // Application Simulation
        function simulatePreApproval() {
            const btn = event.target;
            const originalText = btn.textContent;
            
            btn.disabled = true;
            btn.textContent = '🔍 Checking...';
            
            const statusEl = document.getElementById('statusDisplay');
            const progressEl = document.getElementById('progressFill');
            const messageEl = document.getElementById('approvalMessage');
            
            statusEl.textContent = '🔍 Running Pre-Check...';
            statusEl.className = 'approval-status status-pending';
            
            // Animate progress
            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += Math.random() * 15 + 5;
                progressEl.style.width = Math.min(progress, 100) + '%';
                
                if (progress >= 100) {
                    clearInterval(progressInterval);
                    
                    // Show result
                    setTimeout(() => {
                        const isApproved = currentCreditScore >= 550; // Minimum threshold
                        
                        if (isApproved) {
                            statusEl.textContent = '✅ Pre-Approved!';
                            statusEl.className = 'approval-status status-approved';
                            messageEl.textContent = `Great! You're pre-approved for up to ₹${Math.floor(selectedCargo.value * (creditTiers[currentTier].percentage / 100)).toLocaleString()}. Ready to apply?`;
                            
                            showNotification('✅ Pre-Approval Success', 'You qualify for instant SCF approval!');
                        } else {
                            statusEl.textContent = '❌ Pre-Check Failed';
                            statusEl.className = 'approval-status status-rejected';
                            messageEl.textContent = 'Credit score too low for instant approval. Consider improving credit factors.';
                            
                            showNotification('❌ Pre-Approval Declined', 'Credit score needs improvement for SCF eligibility.');
                        }
                        
                        btn.disabled = false;
                        btn.textContent = originalText;
                        
                        // Reset after 5 seconds
                        setTimeout(() => {
                            progressEl.style.width = '0%';
                            statusEl.textContent = '🔄 Ready for Application';
                            statusEl.className = 'approval-status status-pending';
                            messageEl.textContent = 'Click "Apply for SCF" to start instant processing';
                        }, 5000);
                        
                    }, 1000);
                }
            }, 100);
        }

        function simulateApplication() {
            const btn = document.getElementById('applyBtn');
            const downloadBtn = document.getElementById('downloadBtn');
            const originalText = btn.textContent;
            
            btn.disabled = true;
            btn.textContent = '⏳ Processing...';
            
            const statusEl = document.getElementById('statusDisplay');
            const progressEl = document.getElementById('progressFill');
            const messageEl = document.getElementById('approvalMessage');
            const approvalStatusEl = document.getElementById('approvalStatus');
            
            // Processing stages
            const stages = [
                { text: '🔍 Verifying Identity...', duration: 1000 },
                { text: '📊 Analyzing Credit Score...', duration: 1500 },
                { text: '📦 Assessing Collateral...', duration: 1200 },
                { text: '🏦 Checking Bank Details...', duration: 800 },
                { text: '⚡ Final Approval...', duration: 1000 }
            ];
            
            let currentStage = 0;
            let progress = 0;
            
            function processStage() {
                if (currentStage < stages.length) {
                    const stage = stages[currentStage];
                    statusEl.textContent = stage.text;
                    statusEl.className = 'approval-status status-pending';
                    approvalStatusEl.textContent = 'PROCESSING';
                    
                    // Animate progress for this stage
                    const stageProgress = 100 / stages.length;
                    const startProgress = progress;
                    const endProgress = progress + stageProgress;
                    
                    const stageInterval = setInterval(() => {
                        progress += (endProgress - startProgress) / (stage.duration / 50);
                        progressEl.style.width = Math.min(progress, endProgress) + '%';
                        
                        if (progress >= endProgress) {
                            clearInterval(stageInterval);
                            currentStage++;
                            
                            setTimeout(() => {
                                processStage();
                            }, 200);
                        }
                    }, 50);
                } else {
                    // Final result
                    setTimeout(() => {
                        const isApproved = currentCreditScore >= 550;
                        const scfAmount = document.getElementById('scfAmountDisplay').textContent;
                        const netAmount = document.getElementById('netAmount').textContent;
                        
                        if (isApproved) {
                            statusEl.textContent = '🎉 APPROVED INSTANTLY!';
                            statusEl.className = 'approval-status status-approved';
                            approvalStatusEl.textContent = 'APPROVED';
                            messageEl.innerHTML = `
                                <strong>Congratulations!</strong><br>
                                SCF Amount: ${scfAmount}<br>
                                You Receive: ${netAmount}<br>
                                <small>Funds will be transferred within 2 hours</small>
                            `;
                            
                            btn.style.display = 'none';
                            downloadBtn.style.display = 'inline-flex';
                            
                            showNotification('🎉 SCF APPROVED!', `Instant approval for ${scfAmount}. Funds transferring now!`);
                            
                            // Add to activity (if dashboard is available)
                            setTimeout(() => {
                                showNotification('💰 Funds Transfer', 'SCF funds have been credited to your account!');
                            }, 3000);
                            
                        } else {
                            statusEl.textContent = '❌ Application Declined';
                            statusEl.className = 'approval-status status-rejected';
                            approvalStatusEl.textContent = 'DECLINED';
                            messageEl.textContent = 'Application declined due to credit score requirements. You can reapply after improving your credit profile.';
                            
                            showNotification('❌ Application Declined', 'Credit requirements not met. Please improve credit factors and reapply.');
                        }
                        
                        btn.disabled = false;
                        btn.textContent = originalText;
                        
                    }, 500);
                }
            }
            
            processStage();
        }

        function downloadSCFReport() {
            showNotification('📄 Generating Agreement', 'SCF loan agreement and terms being prepared...');
            
            setTimeout(() => {
                showNotification('📄 Download Complete', 'SCF agreement downloaded successfully. Please review and sign.');
            }, 2000);
        }

        // Utility Functions
        function animateValue(element, newValue) {
            const currentValue = element.textContent;
            if (currentValue !== newValue.toString()) {
                element.style.color = '#22c55e';
                element.style.transform = 'scale(1.05)';
                element.textContent = newValue;
                
                setTimeout(() => {
                    element.style.color = '';
                    element.style.transform = 'scale(1)';
                }, 400);
            }
        }

        function showNotification(title, text) {
            const notification = document.getElementById('notification');
            const titleEl = document.getElementById('notificationTitle');
            const textEl = document.getElementById('notificationText');
            
            titleEl.textContent = title;
            textEl.textContent = text;
            
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 4000);
        }

        // Cleanup
        window.addEventListener('beforeunload', function() {
            clearInterval(marketUpdateInterval);
            clearInterval(creditUpdateInterval);
        });

        // Auto-demo mode (optional)
        function startAutoDemo() {
            const cargos = document.querySelectorAll('.cargo-option');
            let cargoIndex = 0;
            
            setInterval(() => {
                // Switch cargo
                cargos[cargoIndex].click();
                cargoIndex = (cargoIndex + 1) % cargos.length;
                
                // Random credit adjustments
                setTimeout(() => {
                    const sliders = ['paymentHistory', 'businessAge', 'revenue'];
                    const randomSlider = sliders[Math.floor(Math.random() * sliders.length)];
                    const slider = document.getElementById(randomSlider);
                    const range = slider.max - slider.min;
                    slider.value = parseInt(slider.min) + Math.floor(Math.random() * range);
                    updateCreditScore();
                }, 2000);
                
            }, 8000);
        }

        // Uncomment to enable auto-demo
        // setTimeout(startAutoDemo, 10000);
    </script>
</body>
</html>, name: 'Brazilian Real', flag: '🇧🇷' },
            'MXN': { symbol: 'Mex

        // Credit Tiers Configuration
        const creditTiers = {
            excellent: { 
                min: 750, max: 850, percentage: 65, 
                rates: { 30: 8, 60: 10, 90: 12, 120: 14 }, 
                processingFee: 0.5,
                class: 'score-excellent'
            },
            good: { 
                min: 650, max: 749, percentage: 55, 
                rates: { 30: 10, 60: 12, 90: 14, 120: 16 }, 
                processingFee: 0.75,
                class: 'score-good'
            },
            fair: { 
                min: 550, max: 649, percentage: 45, 
                rates: { 30: 12, 60: 14, 90: 16, 120: 18 }, 
                processingFee: 1.0,
                class: 'score-fair'
            },
            poor: { 
                min: 300, max: 549, percentage: 30, 
                rates: { 30: 15, 60: 17, 90: 19, 120: 22 }, 
                processingFee: 1.5,
                class: 'score-poor'
            }
        };

        // Initialize System
        document.addEventListener('DOMContentLoaded', function() {
            updateCreditScore();
            calculateSCF();
            startMarketUpdates();
            startCreditMonitoring();
            
            // Welcome notification
            setTimeout(() => {
                showNotification('🎉 SCF System Online', 'Live credit assessment and real-time calculations active!');
            }, 1000);
        });

        // Cargo Selection
        function selectCargo(element) {
            document.querySelectorAll('.cargo-option').forEach(option => {
                option.classList.remove('selected');
            });
            element.classList.add('selected');
            
            selectedCargo = {
                value: parseInt(element.dataset.value),
                damage: parseInt(element.dataset.damage),
                type: element.dataset.type
            };
            
            // Update auction value display
            document.getElementById('auctionValue').value = `₹${selectedCargo.value.toLocaleString()}`;
            
            // Update SCF slider max
            const maxSCF = Math.floor(selectedCargo.value * (creditTiers[currentTier].percentage / 100));
            const scfSlider = document.getElementById('scfAmount');
            scfSlider.max = maxSCF;
            
            // Reset to 50% of max eligibility
            const newAmount = Math.floor(maxSCF * 0.75);
            scfSlider.value = newAmount;
            
            updateCreditScore();
            calculateSCF();
            
            showNotification('📦 Cargo Updated', `Selected ${element.querySelector('.cargo-name').textContent} worth ${element.querySelector('.cargo-value').textContent}`);
        }

        // Credit Score Calculation
        function updateCreditScore() {
            const paymentHistory = parseInt(document.getElementById('paymentHistory').value);
            const businessAge = parseInt(document.getElementById('businessAge').value);
            const revenue = parseFloat(document.getElementById('revenue').value);
            
            // Update slider displays
            document.getElementById('paymentValue').textContent = paymentHistory;
            document.getElementById('ageValue').textContent = `${businessAge} Years`;
            document.getElementById('revenueValue').textContent = `₹${revenue} Cr`;
            
            // Calculate composite score
            let score = Math.floor(
                paymentHistory * 0.4 +  // 40% weight
                Math.min(businessAge * 25, 200) +  // Business age factor
                Math.min(revenue * 15, 150) +  // Revenue factor
                Math.random() * 20 - 10  // Small random variation
            );
            
            // Adjust for cargo type risk
            const cargoRiskAdjustment = {
                electronics: -10,
                textiles: 0,
                machinery: -15,
                chemicals: -20
            };
            score += cargoRiskAdjustment[selectedCargo.type] || 0;
            
            // Adjust for damage percentage
            score -= selectedCargo.damage * 0.5;
            
            // Ensure score is within bounds
            score = Math.max(300, Math.min(850, score));
            
            currentCreditScore = score;
            
            // Determine tier
            for (const [tier, config] of Object.entries(creditTiers)) {
                if (score >= config.min && score <= config.max) {
                    currentTier = tier;
                    break;
                }
            }
            
            // Update display with animation
            const scoreCircle = document.getElementById('scoreCircle');
            const scoreElement = document.getElementById('creditScore');
            const tierElement = document.getElementById('scoreTier');
            const rangeElement = document.getElementById('scoreRange');
            const eligibilityPercent = document.getElementById('eligibilityPercent');
            const eligibilityAmount = document.getElementById('eligibilityAmount');
            
            // Animate score change
            animateValue(scoreElement, score);
            
            // Update visual styling
            scoreCircle.className = `score-circle ${creditTiers[currentTier].class}`;
            tierElement.textContent = currentTier.toUpperCase();
            rangeElement.textContent = `${creditTiers[currentTier].min} - ${creditTiers[currentTier].max} Range`;
            
            // Update eligibility
            const percentage = creditTiers[currentTier].percentage;
            const maxAmount = Math.floor(selectedCargo.value * (percentage / 100));
            
            animateValue(eligibilityPercent, `${percentage}%`);
            animateValue(eligibilityAmount, `₹${maxAmount.toLocaleString()}`);
            
            // Update SCF slider max
            const scfSlider = document.getElementById('scfAmount');
            scfSlider.max = maxAmount;
            if (parseInt(scfSlider.value) > maxAmount) {
                scfSlider.value = maxAmount;
            }
            
            // Update risk assessment
            updateRiskAssessment();
            
            // Animate panel
            document.getElementById('creditPanel').classList.add('updating');
            setTimeout(() => {
                document.getElementById('creditPanel').classList.remove('updating');
            }, 500);
            
            // Recalculate SCF
            calculateSCF();
        }

        // SCF Calculation
        function calculateSCF() {
            const scfAmount = parseInt(document.getElementById('scfAmount').value);
            const periodSelect = document.getElementById('repaymentPeriod');
            const period = parseInt(periodSelect.value);
            const rate = parseInt(periodSelect.selectedOptions[0].dataset.rate);
            
            // Update slider display
            document.getElementById('scfValue').textContent = `₹${scfAmount.toLocaleString()}`;
            
            const tier = creditTiers[currentTier];
            const interestRate = tier.rates[period];
            const processingFeeRate = tier.processingFee;
            
            // Calculate amounts
            const interest = Math.floor((scfAmount * interestRate * period) / (365 * 100));
            const processingFee = Math.floor(scfAmount * processingFeeRate / 100);
            const netAmount = scfAmount - processingFee;
            const repaymentAmount = scfAmount + interest;
            
            // Update display with animation
            animateValue(document.getElementById('scfAmountDisplay'), `₹${scfAmount.toLocaleString()}`);
            animateValue(document.getElementById('interestRateDisplay'), `${interestRate}% APR`);
            animateValue(document.getElementById('interestAmount'), `₹${interest.toLocaleString()}`);
            animateValue(document.getElementById('processingFee'), `₹${processingFee.toLocaleString()}`);
            animateValue(document.getElementById('netAmount'), `₹${netAmount.toLocaleString()}`);
            animateValue(document.getElementById('repaymentAmount'), `₹${repaymentAmount.toLocaleString()}`);
            
            // Animate calculation panel
            document.getElementById('calculationPanel').classList.add('updating');
            setTimeout(() => {
                document.getElementById('calculationPanel').classList.remove('updating');
            }, 300);
        }

        // Risk Assessment Update
        function updateRiskAssessment() {
            const creditRiskEl = document.getElementById('creditRisk');
            const marketRiskEl = document.getElementById('marketRisk');
            const recoveryRiskEl = document.getElementById('recoveryRisk');
            
            // Credit risk based on score
            let creditRisk, marketRisk, recoveryRisk;
            
            if (currentCreditScore >= 750) {
                creditRisk = 'LOW';
                creditRiskEl.style.color = '#22c55e';
            } else if (currentCreditScore >= 650) {
                creditRisk = 'MEDIUM';
                creditRiskEl.style.color = '#f59e0b';
            } else {
                creditRisk = 'HIGH';
                creditRiskEl.style.color = '#ef4444';
            }
            
            // Market risk based on cargo type and damage
            const damageRisk = selectedCargo.damage > 50 ? 'HIGH' : selectedCargo.damage > 30 ? 'MEDIUM' : 'LOW';
            marketRisk = damageRisk;
            
            if (damageRisk === 'LOW') {
                marketRiskEl.style.color = '#22c55e';
            } else if (damageRisk === 'MEDIUM') {
                marketRiskEl.style.color = '#f59e0b';
            } else {
                marketRiskEl.style.color = '#ef4444';
            }
            
            // Recovery risk (inverse of damage)
            recoveryRisk = selectedCargo.damage < 30 ? 'HIGH' : selectedCargo.damage < 60 ? 'MEDIUM' : 'LOW';
            
            creditRiskEl.textContent = creditRisk;
            marketRiskEl.textContent = marketRisk;
            recoveryRiskEl.textContent = recoveryRisk;
        }

        // Market Data Updates
        function startMarketUpdates() {
            marketUpdateInterval = setInterval(() => {
                updateMarketData();
            }, 3000);
            
            updateMarketData(); // Initial update
        }

        function updateMarketData() {
            const data = {
                interestRates: (Math.random() * 0.4 + 8.0).toFixed(1) + '%',
                approvalRate: (Math.random() * 6 + 92).toFixed(0) + '%',
                avgProcessing: (Math.random() * 1.5 + 1.8).toFixed(1) + 'h',
                totalSCF: (Math.random() * 3 + 11).toFixed(1) + 'L',
                recoveryRate: (Math.random() * 8 + 84).toFixed(0) + '%',
                activeLoans: Math.floor(Math.random() * 20 + 150)
            };
            
            Object.keys(data).forEach(key => {
                const element = document.getElementById(key);
                if (element && element.textContent !== data[key]) {
                    animateValue(element, data[key]);
                }
            });
        }

        // Credit Monitoring
        function startCreditMonitoring() {
            creditUpdateInterval = setInterval(() => {
                // Small random credit score fluctuations
                if (Math.random() < 0.3) { // 30% chance
                    const currentScore = parseInt(document.getElementById('creditScore').textContent);
                    const variation = Math.floor(Math.random() * 6) - 3; // -3 to +3
                    const newScore = Math.max(300, Math.min(850, currentScore + variation));
                    
                    if (newScore !== currentScore) {
                        currentCreditScore = newScore;
                        animateValue(document.getElementById('creditScore'), newScore);
                        
                        showNotification('📊 Credit Update', `Credit score updated to ${newScore} (${variation > 0 ? '+' : ''}${variation})`);
                    }
                }
            }, 8000);
        }

        // Application Simulation
        function simulatePreApproval() {
            const btn = event.target;
            const originalText = btn.textContent;
            
            btn.disabled = true;
            btn.textContent = '🔍 Checking...';
            
            const statusEl = document.getElementById('statusDisplay');
            const progressEl = document.getElementById('progressFill');
            const messageEl = document.getElementById('approvalMessage');
            
            statusEl.textContent = '🔍 Running Pre-Check...';
            statusEl.className = 'approval-status status-pending';
            
            // Animate progress
            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += Math.random() * 15 + 5;
                progressEl.style.width = Math.min(progress, 100) + '%';
                
                if (progress >= 100) {
                    clearInterval(progressInterval);
                    
                    // Show result
                    setTimeout(() => {
                        const isApproved = currentCreditScore >= 550; // Minimum threshold
                        
                        if (isApproved) {
                            statusEl.textContent = '✅ Pre-Approved!';
                            statusEl.className = 'approval-status status-approved';
                            messageEl.textContent = `Great! You're pre-approved for up to ₹${Math.floor(selectedCargo.value * (creditTiers[currentTier].percentage / 100)).toLocaleString()}. Ready to apply?`;
                            
                            showNotification('✅ Pre-Approval Success', 'You qualify for instant SCF approval!');
                        } else {
                            statusEl.textContent = '❌ Pre-Check Failed';
                            statusEl.className = 'approval-status status-rejected';
                            messageEl.textContent = 'Credit score too low for instant approval. Consider improving credit factors.';
                            
                            showNotification('❌ Pre-Approval Declined', 'Credit score needs improvement for SCF eligibility.');
                        }
                        
                        btn.disabled = false;
                        btn.textContent = originalText;
                        
                        // Reset after 5 seconds
                        setTimeout(() => {
                            progressEl.style.width = '0%';
                            statusEl.textContent = '🔄 Ready for Application';
                            statusEl.className = 'approval-status status-pending';
                            messageEl.textContent = 'Click "Apply for SCF" to start instant processing';
                        }, 5000);
                        
                    }, 1000);
                }
            }, 100);
        }

        function simulateApplication() {
            const btn = document.getElementById('applyBtn');
            const downloadBtn = document.getElementById('downloadBtn');
            const originalText = btn.textContent;
            
            btn.disabled = true;
            btn.textContent = '⏳ Processing...';
            
            const statusEl = document.getElementById('statusDisplay');
            const progressEl = document.getElementById('progressFill');
            const messageEl = document.getElementById('approvalMessage');
            const approvalStatusEl = document.getElementById('approvalStatus');
            
            // Processing stages
            const stages = [
                { text: '🔍 Verifying Identity...', duration: 1000 },
                { text: '📊 Analyzing Credit Score...', duration: 1500 },
                { text: '📦 Assessing Collateral...', duration: 1200 },
                { text: '🏦 Checking Bank Details...', duration: 800 },
                { text: '⚡ Final Approval...', duration: 1000 }
            ];
            
            let currentStage = 0;
            let progress = 0;
            
            function processStage() {
                if (currentStage < stages.length) {
                    const stage = stages[currentStage];
                    statusEl.textContent = stage.text;
                    statusEl.className = 'approval-status status-pending';
                    approvalStatusEl.textContent = 'PROCESSING';
                    
                    // Animate progress for this stage
                    const stageProgress = 100 / stages.length;
                    const startProgress = progress;
                    const endProgress = progress + stageProgress;
                    
                    const stageInterval = setInterval(() => {
                        progress += (endProgress - startProgress) / (stage.duration / 50);
                        progressEl.style.width = Math.min(progress, endProgress) + '%';
                        
                        if (progress >= endProgress) {
                            clearInterval(stageInterval);
                            currentStage++;
                            
                            setTimeout(() => {
                                processStage();
                            }, 200);
                        }
                    }, 50);
                } else {
                    // Final result
                    setTimeout(() => {
                        const isApproved = currentCreditScore >= 550;
                        const scfAmount = document.getElementById('scfAmountDisplay').textContent;
                        const netAmount = document.getElementById('netAmount').textContent;
                        
                        if (isApproved) {
                            statusEl.textContent = '🎉 APPROVED INSTANTLY!';
                            statusEl.className = 'approval-status status-approved';
                            approvalStatusEl.textContent = 'APPROVED';
                            messageEl.innerHTML = `
                                <strong>Congratulations!</strong><br>
                                SCF Amount: ${scfAmount}<br>
                                You Receive: ${netAmount}<br>
                                <small>Funds will be transferred within 2 hours</small>
                            `;
                            
                            btn.style.display = 'none';
                            downloadBtn.style.display = 'inline-flex';
                            
                            showNotification('🎉 SCF APPROVED!', `Instant approval for ${scfAmount}. Funds transferring now!`);
                            
                            // Add to activity (if dashboard is available)
                            setTimeout(() => {
                                showNotification('💰 Funds Transfer', 'SCF funds have been credited to your account!');
                            }, 3000);
                            
                        } else {
                            statusEl.textContent = '❌ Application Declined';
                            statusEl.className = 'approval-status status-rejected';
                            approvalStatusEl.textContent = 'DECLINED';
                            messageEl.textContent = 'Application declined due to credit score requirements. You can reapply after improving your credit profile.';
                            
                            showNotification('❌ Application Declined', 'Credit requirements not met. Please improve credit factors and reapply.');
                        }
                        
                        btn.disabled = false;
                        btn.textContent = originalText;
                        
                    }, 500);
                }
            }
            
            processStage();
        }

        function downloadSCFReport() {
            showNotification('📄 Generating Agreement', 'SCF loan agreement and terms being prepared...');
            
            setTimeout(() => {
                showNotification('📄 Download Complete', 'SCF agreement downloaded successfully. Please review and sign.');
            }, 2000);
        }

        // Utility Functions
        function animateValue(element, newValue) {
            const currentValue = element.textContent;
            if (currentValue !== newValue.toString()) {
                element.style.color = '#22c55e';
                element.style.transform = 'scale(1.05)';
                element.textContent = newValue;
                
                setTimeout(() => {
                    element.style.color = '';
                    element.style.transform = 'scale(1)';
                }, 400);
            }
        }

        function showNotification(title, text) {
            const notification = document.getElementById('notification');
            const titleEl = document.getElementById('notificationTitle');
            const textEl = document.getElementById('notificationText');
            
            titleEl.textContent = title;
            textEl.textContent = text;
            
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 4000);
        }

        // Cleanup
        window.addEventListener('beforeunload', function() {
            clearInterval(marketUpdateInterval);
            clearInterval(creditUpdateInterval);
        });

        // Auto-demo mode (optional)
        function startAutoDemo() {
            const cargos = document.querySelectorAll('.cargo-option');
            let cargoIndex = 0;
            
            setInterval(() => {
                // Switch cargo
                cargos[cargoIndex].click();
                cargoIndex = (cargoIndex + 1) % cargos.length;
                
                // Random credit adjustments
                setTimeout(() => {
                    const sliders = ['paymentHistory', 'businessAge', 'revenue'];
                    const randomSlider = sliders[Math.floor(Math.random() * sliders.length)];
                    const slider = document.getElementById(randomSlider);
                    const range = slider.max - slider.min;
                    slider.value = parseInt(slider.min) + Math.floor(Math.random() * range);
                    updateCreditScore();
                }, 2000);
                
            }, 8000);
        }

        // Uncomment to enable auto-demo
        // setTimeout(startAutoDemo, 10000);
    </script>
</body>
</html>, name: 'Mexican Peso', flag: '🇲🇽' },
            'RUB': { symbol: '₽', name: 'Russian Ruble', flag: '🇷🇺' },
            'ZAR': { symbol: 'R', name: 'South African Rand', flag: '🇿🇦' },
            'THB': { symbol: '฿', name: 'Thai Baht', flag: '🇹🇭' },
            'MYR': { symbol: 'RM', name: 'Malaysian Ringgit', flag: '🇲🇾' }
        };

        // Base exchange rates (INR as base)
        const baseExchangeRates = {
            'INR': 1.0,
            'USD': 0.012,    // 1 INR = 0.012 USD
            'EUR': 0.011,    // 1 INR = 0.011 EUR
            'GBP': 0.0095,   // 1 INR = 0.0095 GBP
            'JPY': 1.8,      // 1 INR = 1.8 JPY
            'CNY': 0.087,    // 1 INR = 0.087 CNY
            'AUD': 0.018,    // 1 INR = 0.018 AUD
            'CAD': 0.016,    // 1 INR = 0.016 CAD
            'CHF': 0.011,    // 1 INR = 0.011 CHF
            'SGD': 0.016,    // 1 INR = 0.016 SGD
            'HKD': 0.094,    // 1 INR = 0.094 HKD
            'AED': 0.044,    // 1 INR = 0.044 AED
            'SAR': 0.045,    // 1 INR = 0.045 SAR
            'KRW': 16.2,     // 1 INR = 16.2 KRW
            'BRL': 0.068,    // 1 INR = 0.068 BRL
            'MXN': 0.24,     // 1 INR = 0.24 MXN
            'RUB': 1.2,      // 1 INR = 1.2 RUB
            'ZAR': 0.22,     // 1 INR = 0.22 ZAR
            'THB': 0.42,     // 1 INR = 0.42 THB
            'MYR': 0.054     // 1 INR = 0.054 MYR
        };

        // Credit Tiers Configuration
        const creditTiers = {
            excellent: { 
                min: 750, max: 850, percentage: 65, 
                rates: { 30: 8, 60: 10, 90: 12, 120: 14 }, 
                processingFee: 0.5,
                class: 'score-excellent'
            },
            good: { 
                min: 650, max: 749, percentage: 55, 
                rates: { 30: 10, 60: 12, 90: 14, 120: 16 }, 
                processingFee: 0.75,
                class: 'score-good'
            },
            fair: { 
                min: 550, max: 649, percentage: 45, 
                rates: { 30: 12, 60: 14, 90: 16, 120: 18 }, 
                processingFee: 1.0,
                class: 'score-fair'
            },
            poor: { 
                min: 300, max: 549, percentage: 30, 
                rates: { 30: 15, 60: 17, 90: 19, 120: 22 }, 
                processingFee: 1.5,
                class: 'score-poor'
            }
        };

        // Initialize System
        document.addEventListener('DOMContentLoaded', function() {
            updateCreditScore();
            calculateSCF();
            startMarketUpdates();
            startCreditMonitoring();
            
            // Welcome notification
            setTimeout(() => {
                showNotification('🎉 SCF System Online', 'Live credit assessment and real-time calculations active!');
            }, 1000);
        });

        // Cargo Selection
        function selectCargo(element) {
            document.querySelectorAll('.cargo-option').forEach(option => {
                option.classList.remove('selected');
            });
            element.classList.add('selected');
            
            selectedCargo = {
                value: parseInt(element.dataset.value),
                damage: parseInt(element.dataset.damage),
                type: element.dataset.type
            };
            
            // Update auction value display
            document.getElementById('auctionValue').value = `₹${selectedCargo.value.toLocaleString()}`;
            
            // Update SCF slider max
            const maxSCF = Math.floor(selectedCargo.value * (creditTiers[currentTier].percentage / 100));
            const scfSlider = document.getElementById('scfAmount');
            scfSlider.max = maxSCF;
            
            // Reset to 50% of max eligibility
            const newAmount = Math.floor(maxSCF * 0.75);
            scfSlider.value = newAmount;
            
            updateCreditScore();
            calculateSCF();
            
            showNotification('📦 Cargo Updated', `Selected ${element.querySelector('.cargo-name').textContent} worth ${element.querySelector('.cargo-value').textContent}`);
        }

        // Credit Score Calculation
        function updateCreditScore() {
            const paymentHistory = parseInt(document.getElementById('paymentHistory').value);
            const businessAge = parseInt(document.getElementById('businessAge').value);
            const revenue = parseFloat(document.getElementById('revenue').value);
            
            // Update slider displays
            document.getElementById('paymentValue').textContent = paymentHistory;
            document.getElementById('ageValue').textContent = `${businessAge} Years`;
            document.getElementById('revenueValue').textContent = `₹${revenue} Cr`;
            
            // Calculate composite score
            let score = Math.floor(
                paymentHistory * 0.4 +  // 40% weight
                Math.min(businessAge * 25, 200) +  // Business age factor
                Math.min(revenue * 15, 150) +  // Revenue factor
                Math.random() * 20 - 10  // Small random variation
            );
            
            // Adjust for cargo type risk
            const cargoRiskAdjustment = {
                electronics: -10,
                textiles: 0,
                machinery: -15,
                chemicals: -20
            };
            score += cargoRiskAdjustment[selectedCargo.type] || 0;
            
            // Adjust for damage percentage
            score -= selectedCargo.damage * 0.5;
            
            // Ensure score is within bounds
            score = Math.max(300, Math.min(850, score));
            
            currentCreditScore = score;
            
            // Determine tier
            for (const [tier, config] of Object.entries(creditTiers)) {
                if (score >= config.min && score <= config.max) {
                    currentTier = tier;
                    break;
                }
            }
            
            // Update display with animation
            const scoreCircle = document.getElementById('scoreCircle');
            const scoreElement = document.getElementById('creditScore');
            const tierElement = document.getElementById('scoreTier');
            const rangeElement = document.getElementById('scoreRange');
            const eligibilityPercent = document.getElementById('eligibilityPercent');
            const eligibilityAmount = document.getElementById('eligibilityAmount');
            
            // Animate score change
            animateValue(scoreElement, score);
            
            // Update visual styling
            scoreCircle.className = `score-circle ${creditTiers[currentTier].class}`;
            tierElement.textContent = currentTier.toUpperCase();
            rangeElement.textContent = `${creditTiers[currentTier].min} - ${creditTiers[currentTier].max} Range`;
            
            // Update eligibility
            const percentage = creditTiers[currentTier].percentage;
            const maxAmount = Math.floor(selectedCargo.value * (percentage / 100));
            
            animateValue(eligibilityPercent, `${percentage}%`);
            animateValue(eligibilityAmount, `₹${maxAmount.toLocaleString()}`);
            
            // Update SCF slider max
            const scfSlider = document.getElementById('scfAmount');
            scfSlider.max = maxAmount;
            if (parseInt(scfSlider.value) > maxAmount) {
                scfSlider.value = maxAmount;
            }
            
            // Update risk assessment
            updateRiskAssessment();
            
            // Animate panel
            document.getElementById('creditPanel').classList.add('updating');
            setTimeout(() => {
                document.getElementById('creditPanel').classList.remove('updating');
            }, 500);
            
            // Recalculate SCF
            calculateSCF();
        }

        // SCF Calculation
        function calculateSCF() {
            const scfAmount = parseInt(document.getElementById('scfAmount').value);
            const periodSelect = document.getElementById('repaymentPeriod');
            const period = parseInt(periodSelect.value);
            const rate = parseInt(periodSelect.selectedOptions[0].dataset.rate);
            
            // Update slider display
            document.getElementById('scfValue').textContent = `₹${scfAmount.toLocaleString()}`;
            
            const tier = creditTiers[currentTier];
            const interestRate = tier.rates[period];
            const processingFeeRate = tier.processingFee;
            
            // Calculate amounts
            const interest = Math.floor((scfAmount * interestRate * period) / (365 * 100));
            const processingFee = Math.floor(scfAmount * processingFeeRate / 100);
            const netAmount = scfAmount - processingFee;
            const repaymentAmount = scfAmount + interest;
            
            // Update display with animation
            animateValue(document.getElementById('scfAmountDisplay'), `₹${scfAmount.toLocaleString()}`);
            animateValue(document.getElementById('interestRateDisplay'), `${interestRate}% APR`);
            animateValue(document.getElementById('interestAmount'), `₹${interest.toLocaleString()}`);
            animateValue(document.getElementById('processingFee'), `₹${processingFee.toLocaleString()}`);
            animateValue(document.getElementById('netAmount'), `₹${netAmount.toLocaleString()}`);
            animateValue(document.getElementById('repaymentAmount'), `₹${repaymentAmount.toLocaleString()}`);
            
            // Animate calculation panel
            document.getElementById('calculationPanel').classList.add('updating');
            setTimeout(() => {
                document.getElementById('calculationPanel').classList.remove('updating');
            }, 300);
        }

        // Risk Assessment Update
        function updateRiskAssessment() {
            const creditRiskEl = document.getElementById('creditRisk');
            const marketRiskEl = document.getElementById('marketRisk');
            const recoveryRiskEl = document.getElementById('recoveryRisk');
            
            // Credit risk based on score
            let creditRisk, marketRisk, recoveryRisk;
            
            if (currentCreditScore >= 750) {
                creditRisk = 'LOW';
                creditRiskEl.style.color = '#22c55e';
            } else if (currentCreditScore >= 650) {
                creditRisk = 'MEDIUM';
                creditRiskEl.style.color = '#f59e0b';
            } else {
                creditRisk = 'HIGH';
                creditRiskEl.style.color = '#ef4444';
            }
            
            // Market risk based on cargo type and damage
            const damageRisk = selectedCargo.damage > 50 ? 'HIGH' : selectedCargo.damage > 30 ? 'MEDIUM' : 'LOW';
            marketRisk = damageRisk;
            
            if (damageRisk === 'LOW') {
                marketRiskEl.style.color = '#22c55e';
            } else if (damageRisk === 'MEDIUM') {
                marketRiskEl.style.color = '#f59e0b';
            } else {
                marketRiskEl.style.color = '#ef4444';
            }
            
            // Recovery risk (inverse of damage)
            recoveryRisk = selectedCargo.damage < 30 ? 'HIGH' : selectedCargo.damage < 60 ? 'MEDIUM' : 'LOW';
            
            creditRiskEl.textContent = creditRisk;
            marketRiskEl.textContent = marketRisk;
            recoveryRiskEl.textContent = recoveryRisk;
        }

        // Market Data Updates
        function startMarketUpdates() {
            marketUpdateInterval = setInterval(() => {
                updateMarketData();
            }, 3000);
            
            updateMarketData(); // Initial update
        }

        function updateMarketData() {
            const data = {
                interestRates: (Math.random() * 0.4 + 8.0).toFixed(1) + '%',
                approvalRate: (Math.random() * 6 + 92).toFixed(0) + '%',
                avgProcessing: (Math.random() * 1.5 + 1.8).toFixed(1) + 'h',
                totalSCF: (Math.random() * 3 + 11).toFixed(1) + 'L',
                recoveryRate: (Math.random() * 8 + 84).toFixed(0) + '%',
                activeLoans: Math.floor(Math.random() * 20 + 150)
            };
            
            Object.keys(data).forEach(key => {
                const element = document.getElementById(key);
                if (element && element.textContent !== data[key]) {
                    animateValue(element, data[key]);
                }
            });
        }

        // Credit Monitoring
        function startCreditMonitoring() {
            creditUpdateInterval = setInterval(() => {
                // Small random credit score fluctuations
                if (Math.random() < 0.3) { // 30% chance
                    const currentScore = parseInt(document.getElementById('creditScore').textContent);
                    const variation = Math.floor(Math.random() * 6) - 3; // -3 to +3
                    const newScore = Math.max(300, Math.min(850, currentScore + variation));
                    
                    if (newScore !== currentScore) {
                        currentCreditScore = newScore;
                        animateValue(document.getElementById('creditScore'), newScore);
                        
                        showNotification('📊 Credit Update', `Credit score updated to ${newScore} (${variation > 0 ? '+' : ''}${variation})`);
                    }
                }
            }, 8000);
        }

        // Application Simulation
        function simulatePreApproval() {
            const btn = event.target;
            const originalText = btn.textContent;
            
            btn.disabled = true;
            btn.textContent = '🔍 Checking...';
            
            const statusEl = document.getElementById('statusDisplay');
            const progressEl = document.getElementById('progressFill');
            const messageEl = document.getElementById('approvalMessage');
            
            statusEl.textContent = '🔍 Running Pre-Check...';
            statusEl.className = 'approval-status status-pending';
            
            // Animate progress
            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += Math.random() * 15 + 5;
                progressEl.style.width = Math.min(progress, 100) + '%';
                
                if (progress >= 100) {
                    clearInterval(progressInterval);
                    
                    // Show result
                    setTimeout(() => {
                        const isApproved = currentCreditScore >= 550; // Minimum threshold
                        
                        if (isApproved) {
                            statusEl.textContent = '✅ Pre-Approved!';
                            statusEl.className = 'approval-status status-approved';
                            messageEl.textContent = `Great! You're pre-approved for up to ₹${Math.floor(selectedCargo.value * (creditTiers[currentTier].percentage / 100)).toLocaleString()}. Ready to apply?`;
                            
                            showNotification('✅ Pre-Approval Success', 'You qualify for instant SCF approval!');
                        } else {
                            statusEl.textContent = '❌ Pre-Check Failed';
                            statusEl.className = 'approval-status status-rejected';
                            messageEl.textContent = 'Credit score too low for instant approval. Consider improving credit factors.';
                            
                            showNotification('❌ Pre-Approval Declined', 'Credit score needs improvement for SCF eligibility.');
                        }
                        
                        btn.disabled = false;
                        btn.textContent = originalText;
                        
                        // Reset after 5 seconds
                        setTimeout(() => {
                            progressEl.style.width = '0%';
                            statusEl.textContent = '🔄 Ready for Application';
                            statusEl.className = 'approval-status status-pending';
                            messageEl.textContent = 'Click "Apply for SCF" to start instant processing';
                        }, 5000);
                        
                    }, 1000);
                }
            }, 100);
        }

        function simulateApplication() {
            const btn = document.getElementById('applyBtn');
            const downloadBtn = document.getElementById('downloadBtn');
            const originalText = btn.textContent;
            
            btn.disabled = true;
            btn.textContent = '⏳ Processing...';
            
            const statusEl = document.getElementById('statusDisplay');
            const progressEl = document.getElementById('progressFill');
            const messageEl = document.getElementById('approvalMessage');
            const approvalStatusEl = document.getElementById('approvalStatus');
            
            // Processing stages
            const stages = [
                { text: '🔍 Verifying Identity...', duration: 1000 },
                { text: '📊 Analyzing Credit Score...', duration: 1500 },
                { text: '📦 Assessing Collateral...', duration: 1200 },
                { text: '🏦 Checking Bank Details...', duration: 800 },
                { text: '⚡ Final Approval...', duration: 1000 }
            ];
            
            let currentStage = 0;
            let progress = 0;
            
            function processStage() {
                if (currentStage < stages.length) {
                    const stage = stages[currentStage];
                    statusEl.textContent = stage.text;
                    statusEl.className = 'approval-status status-pending';
                    approvalStatusEl.textContent = 'PROCESSING';
                    
                    // Animate progress for this stage
                    const stageProgress = 100 / stages.length;
                    const startProgress = progress;
                    const endProgress = progress + stageProgress;
                    
                    const stageInterval = setInterval(() => {
                        progress += (endProgress - startProgress) / (stage.duration / 50);
                        progressEl.style.width = Math.min(progress, endProgress) + '%';
                        
                        if (progress >= endProgress) {
                            clearInterval(stageInterval);
                            currentStage++;
                            
                            setTimeout(() => {
                                processStage();
                            }, 200);
                        }
                    }, 50);
                } else {
                    // Final result
                    setTimeout(() => {
                        const isApproved = currentCreditScore >= 550;
                        const scfAmount = document.getElementById('scfAmountDisplay').textContent;
                        const netAmount = document.getElementById('netAmount').textContent;
                        
                        if (isApproved) {
                            statusEl.textContent = '🎉 APPROVED INSTANTLY!';
                            statusEl.className = 'approval-status status-approved';
                            approvalStatusEl.textContent = 'APPROVED';
                            messageEl.innerHTML = `
                                <strong>Congratulations!</strong><br>
                                SCF Amount: ${scfAmount}<br>
                                You Receive: ${netAmount}<br>
                                <small>Funds will be transferred within 2 hours</small>
                            `;
                            
                            btn.style.display = 'none';
                            downloadBtn.style.display = 'inline-flex';
                            
                            showNotification('🎉 SCF APPROVED!', `Instant approval for ${scfAmount}. Funds transferring now!`);
                            
                            // Add to activity (if dashboard is available)
                            setTimeout(() => {
                                showNotification('💰 Funds Transfer', 'SCF funds have been credited to your account!');
                            }, 3000);
                            
                        } else {
                            statusEl.textContent = '❌ Application Declined';
                            statusEl.className = 'approval-status status-rejected';
                            approvalStatusEl.textContent = 'DECLINED';
                            messageEl.textContent = 'Application declined due to credit score requirements. You can reapply after improving your credit profile.';
                            
                            showNotification('❌ Application Declined', 'Credit requirements not met. Please improve credit factors and reapply.');
                        }
                        
                        btn.disabled = false;
                        btn.textContent = originalText;
                        
                    }, 500);
                }
            }
            
            processStage();
        }

        function downloadSCFReport() {
            showNotification('📄 Generating Agreement', 'SCF loan agreement and terms being prepared...');
            
            setTimeout(() => {
                showNotification('📄 Download Complete', 'SCF agreement downloaded successfully. Please review and sign.');
            }, 2000);
        }

        // Utility Functions
        function animateValue(element, newValue) {
            const currentValue = element.textContent;
            if (currentValue !== newValue.toString()) {
                element.style.color = '#22c55e';
                element.style.transform = 'scale(1.05)';
                element.textContent = newValue;
                
                setTimeout(() => {
                    element.style.color = '';
                    element.style.transform = 'scale(1)';
                }, 400);
            }
        }

        function showNotification(title, text) {
            const notification = document.getElementById('notification');
            const titleEl = document.getElementById('notificationTitle');
            const textEl = document.getElementById('notificationText');
            
            titleEl.textContent = title;
            textEl.textContent = text;
            
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 4000);
        }

        // Cleanup
        window.addEventListener('beforeunload', function() {
            clearInterval(marketUpdateInterval);
            clearInterval(creditUpdateInterval);
        });

        // Auto-demo mode (optional)
        function startAutoDemo() {
            const cargos = document.querySelectorAll('.cargo-option');
            let cargoIndex = 0;
            
            setInterval(() => {
                // Switch cargo
                cargos[cargoIndex].click();
                cargoIndex = (cargoIndex + 1) % cargos.length;
                
                // Random credit adjustments
                setTimeout(() => {
                    const sliders = ['paymentHistory', 'businessAge', 'revenue'];
                    const randomSlider = sliders[Math.floor(Math.random() * sliders.length)];
                    const slider = document.getElementById(randomSlider);
                    const range = slider.max - slider.min;
                    slider.value = parseInt(slider.min) + Math.floor(Math.random() * range);
                    updateCreditScore();
                }, 2000);
                
            }, 8000);
        }

        // Uncomment to enable auto-demo
        // setTimeout(startAutoDemo, 10000);
    </script>
</body>
</html>